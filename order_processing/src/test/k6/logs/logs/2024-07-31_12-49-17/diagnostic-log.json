[{"message":"2024/07/30 17:59:30.281 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 7874, async-ops: 23596, serverEndpoint: digma-redis:6379, conn-sec: 357273, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=6,Free=32761,Min=1,Max=32767), POOL: (Threads=10,QueuedItems=81,CompletedItems=32950057,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:59:30.2813295","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:48:27.114 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 2, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7817, async-ops: 23887, serverEndpoint: digma-redis:6379, conn-sec: 356610.05, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=88,CompletedItems=32878882,Timers=27), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:48:27.1147719","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:42:40.114 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 7790, async-ops: 23865, serverEndpoint: digma-redis:6379, conn-sec: 356262.71, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=91,CompletedItems=32838635,Timers=27), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:42:40.1149488","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:37:10.131 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 2, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7534, async-ops: 23605, serverEndpoint: digma-redis:6379, conn-sec: 355932.73, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=5,Free=32762,Min=1,Max=32767), POOL: (Threads=14,QueuedItems=95,CompletedItems=32799673,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:37:10.1316668","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:30:13.913 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 7458, async-ops: 23590, serverEndpoint: digma-redis:6379, conn-sec: 355516.62, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=74,CompletedItems=32748256,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:30:13.9139776","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:24:51.177 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout awaiting response (outbound=0KiB, inbound=0KiB, 5504ms elapsed, timeout is 5000ms), command=GET, next: GET throttlingv2-cg-digma-span-duration-window-aggregator, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 5, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7644, async-ops: 23708, serverEndpoint: digma-redis:6379, conn-sec: 355193.9, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=5,Free=32762,Min=1,Max=32767), POOL: (Threads=11,QueuedItems=114,CompletedItems=32704228,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.Kafka.KafkaThrottlingState.GetThrottlingInfo(String group) in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 100\n   at Digma.Common.Kafka.KafkaThrottlingState.GetConsumersGroupsThrottlingState() in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 51\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request) in /src/ApiGateways/Digma.Collector/Services/CollectorServiceBase.cs:line 76\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T17:24:51.1777915","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:22:31.518 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7495, async-ops: 23541, serverEndpoint: digma-redis:6379, conn-sec: 355054.13, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=11,QueuedItems=77,CompletedItems=32684695,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:22:31.5182099","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:17:12.519 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 2, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7416, async-ops: 23532, serverEndpoint: digma-redis:6379, conn-sec: 354735.23, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=94,CompletedItems=32643559,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:17:12.5191652","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:11:21.079 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7386, async-ops: 23431, serverEndpoint: digma-redis:6379, conn-sec: 354383.68, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=102,CompletedItems=32589132,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:11:21.0798689","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 17:05:31.770 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 3, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7535, async-ops: 23656, serverEndpoint: digma-redis:6379, conn-sec: 354034.36, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=97,CompletedItems=32538079,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T17:05:31.7700559","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:59:48.725 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7216, async-ops: 23376, serverEndpoint: digma-redis:6379, conn-sec: 353691.37, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=5,Free=32762,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=111,CompletedItems=32486985,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:59:48.7253685","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:58:11.995 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout awaiting response (outbound=0KiB, inbound=0KiB, 10204ms elapsed, timeout is 5000ms), command=GET, next: GET throttlingv2-cg-digma-traces-processing, inst: 0, qu: 0, qs: 5, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 21, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7507, async-ops: 23598, serverEndpoint: digma-redis:6379, conn-sec: 353594.93, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=11,Free=32756,Min=1,Max=32767), POOL: (Threads=14,QueuedItems=234,CompletedItems=32472125,Timers=26), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.Kafka.KafkaThrottlingState.GetThrottlingInfo(String group) in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 100\n   at Digma.Common.Kafka.KafkaThrottlingState.GetConsumersGroupsThrottlingState() in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 51\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request) in /src/ApiGateways/Digma.Collector/Services/CollectorServiceBase.cs:line 76\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:58:11.9958441","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:54:34.520 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 2, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 7206, async-ops: 23048, serverEndpoint: digma-redis:6379, conn-sec: 353377.13, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=83,CompletedItems=32438657,Timers=28), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:54:34.5204706","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:49:30.218 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7147, async-ops: 23022, serverEndpoint: digma-redis:6379, conn-sec: 353072.82, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=17,Free=32750,Min=1,Max=32767), POOL: (Threads=17,QueuedItems=84,CompletedItems=32389664,Timers=26), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:49:30.2188986","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:42:24.856 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7272, async-ops: 23207, serverEndpoint: digma-redis:6379, conn-sec: 352647.57, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=6,Free=32761,Min=1,Max=32767), POOL: (Threads=11,QueuedItems=130,CompletedItems=32314492,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:42:24.8564123","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:35:24.862 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6999, async-ops: 22936, serverEndpoint: digma-redis:6379, conn-sec: 352227.47, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=7,Free=32760,Min=1,Max=32767), POOL: (Threads=14,QueuedItems=99,CompletedItems=32238161,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:35:24.8626533","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:30:02.491 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 7102, async-ops: 23382, serverEndpoint: digma-redis:6379, conn-sec: 351905.21, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=6,Free=32761,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=121,CompletedItems=32176596,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:30:02.4917152","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:24:50.540 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout awaiting response (outbound=0KiB, inbound=0KiB, 6992ms elapsed, timeout is 5000ms), command=GET, next: GET throttlingv2-cg-digma-pipeline-worker, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 5, in-pipe: 0, out-pipe: 0, last-in: 349, cur-in: 0, sync-ops: 6880, async-ops: 23113, serverEndpoint: digma-redis:6379, conn-sec: 351593.18, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=11,Free=32756,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=179,CompletedItems=32118272,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.Kafka.KafkaThrottlingState.GetThrottlingInfo(String group) in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 100\n   at Digma.Common.Kafka.KafkaThrottlingState.GetConsumersGroupsThrottlingState() in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 51\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request) in /src/ApiGateways/Digma.Collector/Services/CollectorServiceBase.cs:line 76\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:24:50.5403811","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:24:48.652 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 349, cur-in: 0, sync-ops: 6922, async-ops: 23342, serverEndpoint: digma-redis:6379, conn-sec: 351591.26, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=132,CompletedItems=32118246,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:24:48.6520447","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:19:15.263 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6817, async-ops: 23227, serverEndpoint: digma-redis:6379, conn-sec: 351257.85, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=100,CompletedItems=32053223,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:19:15.2634821","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:17:18.431 Error [.NET ThreadPool Worker] Grpc.AspNetCore.Server.ServerCallHandler - Error when executing service method 'Export'.","exception":{"message":"The client reset the request stream.","type":"System.IO.IOException","stackTrace":"   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestPipeReader.ReadAsync(CancellationToken cancellationToken)\n   at Grpc.AspNetCore.Server.Internal.PipeExtensions.ReadSingleMessageAsync[T](PipeReader input, HttpContextServerCallContext serverCallContext, Func`2 deserializer)\n   at Grpc.AspNetCore.Server.Internal.CallHandlers.UnaryServerCallHandler`3.HandleCallAsyncCore(HttpContext httpContext, HttpContextServerCallContext serverCallContext)\n   at Grpc.AspNetCore.Server.Internal.CallHandlers.ServerCallHandlerBase`3.<HandleCallAsync>g__AwaitHandleCall|8_0(HttpContextServerCallContext serverCallContext, Method`2 method, Task handleCall)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:17:18.431952","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:17:18.428 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout awaiting response (outbound=0KiB, inbound=0KiB, 5020ms elapsed, timeout is 5000ms), command=GET, next: GET throttlingv2-cg-digma-span-duration-summary, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 5, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6772, async-ops: 23191, serverEndpoint: digma-redis:6379, conn-sec: 351141.04, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=16,Free=32751,Min=1,Max=32767), POOL: (Threads=16,QueuedItems=148,CompletedItems=32029466,Timers=29), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.Kafka.KafkaThrottlingState.GetThrottlingInfo(String group) in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 100\n   at Digma.Common.Kafka.KafkaThrottlingState.GetConsumersGroupsThrottlingState() in /src/Core/Digma.Common/Kafka/KafkaThrottlingState.cs:line 51\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request) in /src/ApiGateways/Digma.Collector/Services/CollectorServiceBase.cs:line 76\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:17:18.4280883","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:14:12.416 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 4, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6728, async-ops: 23183, serverEndpoint: digma-redis:6379, conn-sec: 350955.12, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=12,QueuedItems=111,CompletedItems=31995756,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:14:12.4164351","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:08:41.063 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6847, async-ops: 23022, serverEndpoint: digma-redis:6379, conn-sec: 350623.78, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=6,Free=32761,Min=1,Max=32767), POOL: (Threads=18,QueuedItems=147,CompletedItems=31926009,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:08:41.0633043","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:07:41.908 Error [.NET ThreadPool Worker] Grpc.AspNetCore.Server.ServerCallHandler - Error when executing service method 'Export'.","exception":{"message":"The client reset the request stream.","type":"System.IO.IOException","stackTrace":"   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestPipeReader.AdvanceTo(SequencePosition consumed)\n   at Grpc.AspNetCore.Server.Internal.PipeExtensions.ReadSingleMessageAsync[T](PipeReader input, HttpContextServerCallContext serverCallContext, Func`2 deserializer)\n   at Grpc.AspNetCore.Server.Internal.CallHandlers.UnaryServerCallHandler`3.HandleCallAsyncCore(HttpContext httpContext, HttpContextServerCallContext serverCallContext)\n   at Grpc.AspNetCore.Server.Internal.CallHandlers.ServerCallHandlerBase`3.<HandleCallAsync>g__AwaitHandleCall|8_0(HttpContextServerCallContext serverCallContext, Method`2 method, Task handleCall)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:07:41.9082342","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 16:03:16.902 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6740, async-ops: 23316, serverEndpoint: digma-redis:6379, conn-sec: 350299.49, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=100,CompletedItems=31855365,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T16:03:16.9026288","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:58:14.695 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 3, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6482, async-ops: 22973, serverEndpoint: digma-redis:6379, conn-sec: 349997.33, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=140,CompletedItems=31791115,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:58:14.6957319","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:53:00.565 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6570, async-ops: 23262, serverEndpoint: digma-redis:6379, conn-sec: 349683.16, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=8,Free=32759,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=118,CompletedItems=31726171,Timers=27), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:53:00.5659379","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:47:08.207 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 1, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 6252, async-ops: 23312, serverEndpoint: digma-redis:6379, conn-sec: 349330.83, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=19,QueuedItems=105,CompletedItems=31645132,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:47:08.207078","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:41:38.640 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: INFO, inst: 1, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 0, in-pipe: 0, out-pipe: 79, last-in: 1, cur-in: 0, sync-ops: 6230, async-ops: 22953, serverEndpoint: digma-redis:6379, conn-sec: 349001.24, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=13,QueuedItems=151,CompletedItems=31575714,Timers=32), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:41:38.6402696","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:34:59.116 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 2, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 8, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 5998, async-ops: 22889, serverEndpoint: digma-redis:6379, conn-sec: 348601.77, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=14,Free=32753,Min=1,Max=32767), POOL: (Threads=27,QueuedItems=103,CompletedItems=31478950,Timers=32), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:34:59.116943","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 15:29:41.336 Error [.NET ThreadPool Worker] Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor - An error occured while processing a8f3f7018e9234b32838da11cdbba2eb-321529979.us-west-2.elb.amazonaws.com:5050//opentelemetry.proto.collector.trace.v1.TraceService/Export","exception":{"message":"Timeout performing EXISTS (5000ms), next: EXISTS force-send-traces-jaeger, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 4, in-pipe: 0, out-pipe: 0, last-in: 1, cur-in: 0, sync-ops: 5694, async-ops: 22972, serverEndpoint: digma-redis:6379, conn-sec: 348284.05, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-deployment-75f6687c4d-kl4l5(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=24,Free=32743,Min=1,Max=32767), POOL: (Threads=43,QueuedItems=95,CompletedItems=31101766,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ExecuteSyncImpl[T](Message message, ResultProcessor`1 processor, ServerEndPoint server, T defaultValue) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2108\n   at StackExchange.Redis.RedisDatabase.KeyExists(RedisKey key, CommandFlags flags) in /_/src/StackExchange.Redis/RedisDatabase.cs:line 809\n   at Digma.Collector.Services.CollectorServiceBase.Export(ExportTraceServiceRequest request)\n   at Digma.Collector.Endpoints.CollectorGrpcEndpoint.Export(ExportTraceServiceRequest request, ServerCallContext context) in /src/ApiGateways/Digma.Collector/Endpoints/CollectorGrpcEndpoint.cs:line 22\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Grpc.Shared.Server.UnaryServerMethodInvoker`3.ResolvedInterceptorInvoker(TRequest resolvedRequest, ServerCallContext resolvedContext)\n   at Digma.Common.Infrastructure.Interceptors.ServerLoggerInterceptor.UnaryServerHandler[TRequest,TResponse](TRequest request, ServerCallContext context, UnaryServerMethod`2 continuation) in /src/Core/Digma.Common/Infrastructure/Interceptors/ServerLoggerInterceptor.cs:line 35","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-30T15:29:41.3366144","application":"Collector","instacneId":"digma-collector-deployment-75f6687c4d-kl4l5"},{"message":"2024/07/30 23:02:46.139 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T23:02:46.1391776","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 22:50:42.230 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T22:50:42.2307897","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 21:51:22.240 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T21:51:22.2400547","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:29:30.683 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T18:29:30.6835253","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:26:51.297 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T18:26:51.2971532","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:20:50.488 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T18:20:50.4887063","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:15:48.837 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T18:15:48.8377073","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:10:46.874 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T18:10:46.8746963","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 18:05:44.915 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T18:05:44.9150339","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:59:45.430 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:59:45.4306504","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:54:45.419 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:54:45.4196122","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:49:43.368 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:49:43.3686946","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:44:42.403 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:44:42.4032954","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:39:41.979 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:39:41.9797633","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:34:39.406 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:34:39.4068841","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:28:39.417 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:28:39.4173612","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:22:40.291 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:22:40.2913691","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:16:39.193 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:16:39.1932726","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:11:38.364 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:11:38.3645879","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:06:37.449 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:06:37.4490819","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 17:00:37.697 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T17:00:37.6976819","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:52:05.743 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:52:05.7438207","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:09:54.046 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:09:54.0467967","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:08:54.256 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:08:54.2561684","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:08:54.178 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:08:54.1784307","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:08:54.104 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:08:54.1044127","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 16:05:53.365 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T16:05:53.3652639","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:57:33.102 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:57:33.1020412","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:54:48.350 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:54:48.3500994","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:52:47.346 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:52:47.3465479","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:52:32.999 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:52:32.9995074","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:46:46.929 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:46:46.929695","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:46:33.652 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:46:33.6529116","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:43:55.748 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:43:55.7480827","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:43:52.900 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:43:52.900092","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:43:45.136 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:43:45.1363434","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:43:45.135 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:43:45.1357001","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:41:46.036 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:41:46.0361385","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:41:31.425 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:41:31.4255395","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:36:44.856 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:36:44.8563033","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:35:50.896 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:35:50.89676","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:35:34.637 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:35:34.6379871","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:30:29.778 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:30:29.7780521","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:28:54.889 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:28:54.8890629","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:27:33.537 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:27:33.5370833","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:25:35.798 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:25:35.7987458","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:25:33.018 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:25:33.0188652","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:25:32.788 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:25:32.7888038","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:24:44.056 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:24:44.05637","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:24:43.679 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:24:43.6791386","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:24:42.329 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:24:42.3290852","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:24:40.365 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:24:40.3659365","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:24:35.405 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:24:35.4052442","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:23:40.187 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:23:40.187105","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:23:30.262 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:23:30.26246","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:23:23.272 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:23:23.2727205","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:23:22.712 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:23:22.7124781","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:53.242 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:53.2426794","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:50.799 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:50.7996943","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:49.634 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:49.6348053","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:48.090 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:48.0902243","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:46.852 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:46.8520772","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:46.600 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:46.6002596","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:44.925 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:44.9251535","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:43.418 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:43.4185173","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:41.653 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:41.6539366","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:40.215 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:40.2152244","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:38.898 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:38.8981505","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:37.873 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:37.8737912","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:36.567 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:36.5678768","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:33.765 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:33.7650267","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:31.276 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:31.2765976","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:30.912 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:30.9122332","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:22:30.790 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:22:30.7908281","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:21:43.467 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:21:43.4674489","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:21:42.438 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:21:42.438165","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:21:28.658 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:21:28.6581951","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:43.166 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:43.1660944","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:41.608 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:41.6081493","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:41.500 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:41.5009895","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:36.697 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:36.6979833","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:35.548 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:35.5481278","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:35.473 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:35.4733151","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:32.416 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:32.4164967","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:30.794 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:30.7941291","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:20:28.887 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:20:28.8875463","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:19:50.123 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:19:50.123902","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:19:42.392 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:19:42.3922539","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:19:22.900 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:19:22.9000782","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:19:16.714 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:19:16.7141042","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:18:44.004 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:18:44.0042207","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:18:39.728 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:18:39.7289682","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:18:28.282 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:18:28.2827384","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:18:26.280 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:18:26.2806703","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:18:14.836 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:18:14.8369184","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:17:48.691 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:17:48.6916244","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:17:45.395 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:17:45.395115","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:17:44.272 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:17:44.272135","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:17:30.894 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:17:30.8945716","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:17:26.604 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:17:26.6041156","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:29.866 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:29.8664257","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:21.987 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:21.9872985","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:17.536 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:17.5361112","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:17.008 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:17.0083967","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:14.975 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:14.9759071","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:13.532 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:13.532763","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:12.853 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:12.8531956","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:16:10.028 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:16:10.0286663","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:44.271 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:44.2711704","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:42.819 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:42.8197911","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:38.112 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:38.1123141","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:37.143 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:37.1438091","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:32.532 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:32.5329444","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:22.596 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:22.5962434","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:22.087 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:22.0875892","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:21.607 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:21.6073188","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:21.023 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:21.0234858","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:12.172 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:12.1723481","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:15:10.556 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:15:10.5563565","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:46.098 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:46.0986041","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:43.588 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:43.5883124","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:28.696 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:28.6965494","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:17.849 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:17.8494482","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:10.220 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:10.2201165","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:14:08.177 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:14:08.1770066","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:13:40.608 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:13:40.6084458","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:13:27.022 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:13:27.0220591","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:13:23.606 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:13:23.6068646","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:12:03.692 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:12:03.6921119","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:11:33.641 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:11:33.641394","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:11:27.757 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:11:27.7579796","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:10:56.791 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:10:56.7917855","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:10:28.995 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:10:28.9952527","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:10:26.152 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:10:26.1522562","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:10:06.521 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:10:06.5213902","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:09:55.041 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:09:55.0410652","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:09:06.224 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:09:06.2240328","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:09:04.984 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:09:04.9849758","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:09:02.129 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:09:02.1294601","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:08:59.921 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:08:59.9216936","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:08:55.330 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:08:55.3300954","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:08:51.133 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:08:51.1338264","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:08:26.479 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:08:26.4791105","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:07:03.980 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:07:03.9804697","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:05:54.630 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:05:54.6301726","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:04:51.333 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:04:51.3330644","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:04:45.745 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T15:04:45.7456468","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 15:03:25.540 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T15:03:25.5402138","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:58:22.859 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:58:22.8599741","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:52:23.097 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:52:23.0978373","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:48:35.956 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:48:35.9561037","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:46:23.122 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:46:23.1229576","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:40:23.120 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:40:23.1203381","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:35:21.826 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:35:21.8268336","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:30:21.764 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:30:21.7645696","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:25:21.295 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:25:21.2954758","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:21:27.972 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:21:27.9720205","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:20:37.057 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:20:37.0570952","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:19:21.498 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:19:21.4980984","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:18:32.769 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:18:32.7696949","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:18:28.824 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:18:28.8241381","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:17:24.939 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T14:17:24.9392662","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:14:20.206 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:14:20.2066407","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:09:19.216 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:09:19.2161126","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 14:04:16.819 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T14:04:16.8198559","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:59:15.438 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:59:15.4387891","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:59:14.020 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:59:14.0201709","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:57:13.750 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:57:13.7503137","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:55:12.381 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:55:12.3813535","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:54:14.494 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:54:14.4946559","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:52:10.338 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:52:10.3381942","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:49:14.365 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:49:14.3659173","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:49:09.730 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:49:09.7306069","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:44:14.282 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:44:14.2827117","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:40:04.354 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:40:04.3549025","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:39:12.303 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:39:12.303052","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:34:11.975 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:34:11.9757846","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:33:15.065 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:33:15.0652455","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:33:13.347 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:33:13.3478123","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:33:12.033 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:33:12.0333293","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:33:11.140 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:33:11.1408516","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:33:06.731 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:33:06.7310394","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:29:11.895 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:29:11.8959743","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:24:11.795 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:24:11.795765","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:19:11.697 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:19:11.6973505","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:14:10.626 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:14:10.6264864","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:09:10.438 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:09:10.4383097","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:05:01.429 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:05:01.4290386","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:04:58.126 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T13:04:58.1261443","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 13:04:10.299 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T13:04:10.2994092","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:59:10.160 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:59:10.160154","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:55:58.930 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:55:58.9303804","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:54:09.159 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:54:09.1598272","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:49:08.260 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:49:08.2606463","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:48:58.677 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:48:58.677506","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:48:57.533 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:48:57.5333201","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:44:07.958 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:44:07.9586047","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:40:54.561 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:40:54.5616814","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:39:07.700 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:39:07.7008328","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:34:06.849 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:34:06.8497261","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:29:06.232 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:29:06.2328443","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:24:06.162 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:24:06.162564","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:22:53.236 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:22:53.2365827","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:22:52.522 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:22:52.5226672","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:22:51.732 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:22:51.7323095","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:22:47.326 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:22:47.3265649","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:19:06.054 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:19:06.0543925","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:14:05.990 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:14:05.9906261","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:09:05.896 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:09:05.8960535","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:04:44.374 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:04:44.3743018","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:04:33.520 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T12:04:33.5201283","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 12:04:04.820 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T12:04:04.8200014","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:36.670 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:36.6709198","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:34.149 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:34.1490052","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:33.953 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:33.9537078","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:33.356 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:33.3563195","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:32.935 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:32.9353692","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:32.229 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:32.2291","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:31.622 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:31.6220007","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:29.421 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:59:29.4215484","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:59:03.990 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T11:59:03.9907611","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:57:38.148 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:57:38.1480598","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:53:07.659 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T11:53:07.6590373","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:48:02.926 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T11:48:02.9264003","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:45:19.186 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:45:19.186839","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:44:22.451 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:44:22.4510058","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:44:18.922 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:44:18.9225963","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:22.842 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:22.8422462","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:21.846 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:21.8461265","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:21.622 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:21.6222595","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:19.861 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:19.8615812","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:19.728 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:19.728186","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:43:17.640 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:43:17.6404882","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:42:03.972 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T11:42:03.9727568","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:41:22.151 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:41:22.1511031","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:37:01.983 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T11:37:01.9838757","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:36:20.259 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:36:20.2592642","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:36:16.666 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:36:16.6660338","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:36:16.612 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:36:16.6123857","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:34:22.239 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:34:22.2399107","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:34:10.325 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:34:10.3253571","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:21:13.540 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:21:13.5400116","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:11:04.420 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:11:04.420361","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 11:03:06.889 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T11:03:06.8894296","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:56:00.984 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T10:56:00.9843432","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:51:57.426 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T10:51:57.4266451","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:33:58.858 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:33:58.858745","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:28:58.791 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:28:58.7915193","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:23:58.708 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:23:58.7084475","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:18:57.794 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:18:57.794119","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:13:56.792 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:13:56.7923911","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:08:56.724 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:08:56.7244036","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 10:02:58.664 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T10:02:58.6641964","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:57:56.048 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T09:57:56.0488489","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:57:49.319 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:57:49.3198824","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:57:46.464 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:57:46.4640799","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:57:38.348 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:57:38.3489218","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:57:36.871 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:57:36.8714175","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:56:53.655 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:56:53.6553331","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:56:50.935 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:56:50.9358935","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:52:55.938 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T09:52:55.9383293","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:52:38.931 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:52:38.9313709","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:52:35.830 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:52:35.8306827","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:51:41.132 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:51:41.1324422","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:46:29.142 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:46:29.1422803","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:36:35.243 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:36:35.2436442","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:32:24.826 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:32:24.8263122","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:30:26.021 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:30:26.0211965","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:29:16.296 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:29:16.2969557","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:20:25.842 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:20:25.8426034","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:20:25.164 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:20:25.1649401","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:20:23.923 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:20:23.9230329","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:20:23.132 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:20:23.1320273","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:20:08.729 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:20:08.7291124","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 09:01:09.460 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T09:01:09.4601955","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:59:01.120 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:59:01.1202987","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:58:00.847 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:58:00.8478523","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:36:52.778 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:36:52.7787726","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:22:45.126 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:22:45.1269487","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:49.430 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:49.4302952","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:48.935 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:48.9352536","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:46.308 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:46.3086018","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:45.445 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:45.4450723","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:45.442 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:45.4423008","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:20:45.442 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:20:45.4423008","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:16:43.147 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:16:43.1475094","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:16:43.108 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:16:43.1087254","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:15:40.322 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:15:40.3225908","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:12:40.525 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:12:40.5253414","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:12:39.650 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:12:39.650463","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:12:38.085 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:12:38.0853671","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:12:37.429 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:12:37.4291016","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:12:37.277 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:12:37.2771106","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:38.352 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:38.3521531","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:37.929 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:37.929693","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:37.471 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:37.4714208","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:36.793 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:36.7931677","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:36.052 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:36.0520303","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:10:36.039 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:10:36.0392053","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:09:39.292 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:09:39.2920562","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:09:38.357 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:09:38.3570024","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:09:38.262 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:09:38.262379","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:09:38.262 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:09:38.262379","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:37.591 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:37.5917814","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:37.078 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:37.0783497","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:35.976 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:35.9760623","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:35.879 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:35.8796967","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:35.873 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:35.873928","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:07:35.094 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:07:35.0943916","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:05:36.660 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:05:36.660881","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:05:36.547 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:05:36.5470771","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:05:35.158 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:05:35.1589885","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:05:34.929 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:05:34.9290551","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:05:34.071 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:05:34.071107","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 08:00:32.444 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T08:00:32.4441711","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:54:30.243 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:54:30.2435795","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:54:28.733 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:54:28.7337069","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:54:26.205 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:54:26.2051335","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:53:35.039 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:53:35.0396429","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:53:32.558 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:53:32.5583513","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:28.134 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:28.1344942","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:27.161 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:27.161141","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:27.128 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:27.1286084","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:26.145 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:26.1457025","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:26.125 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:26.1252371","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:51:25.125 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:51:25.1257114","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:50:31.160 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:50:31.1602592","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:50:27.439 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:50:27.4393618","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:49:24.847 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:49:24.847012","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 07:48:24.535 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-30T07:48:24.535439","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:53:47.630 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:53:47.6305826","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:48:44.398 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:48:44.3984549","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:42:48.155 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:42:48.1553072","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:37:42.990 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:37:42.9901876","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:32:41.787 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:32:41.7875942","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:26:42.267 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:26:42.2672751","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:20:42.275 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:20:42.2755631","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:15:38.004 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:15:38.0049658","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:09:37.263 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:09:37.2630974","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 01:03:35.259 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T01:03:35.2593838","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:58:34.572 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:58:34.5728958","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:52:34.878 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:52:34.8782115","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:47:33.765 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:47:33.7656582","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:42:33.675 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:42:33.6755272","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:37:33.207 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:37:33.2077832","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:32:32.242 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:32:32.2428715","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:27:32.174 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:27:32.1742326","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:22:30.229 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:22:30.2293465","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:17:29.309 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:17:29.3097972","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:11:30.317 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:11:30.3172858","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:06:29.150 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:06:29.1502037","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/30 00:01:28.124 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T00:01:28.1248306","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:56:27.594 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:56:27.5944963","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:51:26.637 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:51:26.6375135","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:46:26.600 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:46:26.6002465","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:41:25.618 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:41:25.6188791","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:36:24.612 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:36:24.6122395","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:31:24.178 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:31:24.1787208","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:26:22.612 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:26:22.612521","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:21:22.468 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:21:22.4689585","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:16:21.995 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:16:21.9955822","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:11:21.959 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:11:21.9597212","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:05:22.373 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:05:22.3737972","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 23:00:20.458 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T23:00:20.4588752","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:55:19.841 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:55:19.8413808","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:49:19.441 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:49:19.4418096","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:44:17.896 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:44:17.8961797","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:39:17.464 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:39:17.4642187","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:34:16.787 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:34:16.787114","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:28:17.542 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:28:17.5428955","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:23:16.284 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:23:16.2846674","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:17:17.235 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:17:17.2359534","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:12:14.695 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:12:14.6956182","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:07:13.468 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:07:13.4682993","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 22:02:11.995 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T22:02:11.9953313","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:56:12.267 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:56:12.2675663","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:51:12.258 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:51:12.2581187","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:46:11.771 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:46:11.7713336","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:41:11.687 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:41:11.687681","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:35:12.162 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:35:12.1621014","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:29:11.593 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:29:11.5936654","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:24:10.596 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:24:10.5963931","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:19:09.353 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:19:09.3538032","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:14:08.769 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:14:08.7691507","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 21:09:08.320 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T21:09:08.3208396","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 20:08:03.284 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T20:08:03.2843615","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 20:03:01.678 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T20:03:01.6785608","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 20:02:06.446 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-29T20:02:06.4462383","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 19:02:56.312 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T19:02:56.3123653","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:56:55.814 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:56:55.814296","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:51:54.580 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:51:54.580687","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:46:53.989 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:46:53.9893416","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:40:54.327 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:40:54.3271261","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:35:52.651 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:35:52.6511008","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:30:50.558 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:30:50.5580576","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:25:48.560 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange) in /src/Services/Analytics/Digma.Insight.Analysis/Analyzers/DurationSlowdownAnalyzer.cs:line 171\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:25:48.5609027","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:20:48.320 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange) in /src/Services/Analytics/Digma.Insight.Analysis/Analyzers/DurationSlowdownAnalyzer.cs:line 171\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:20:48.320397","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/29 18:15:46.744 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange) in /src/Services/Analytics/Digma.Insight.Analysis/Analyzers/DurationSlowdownAnalyzer.cs:line 171\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-29T18:15:46.7448534","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/26 22:21:27.707 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-26T22:21:27.7076473","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/26 14:45:21.846 Error [.NET ThreadPool Worker] KafkaConsumer - Error occurred while processing message (topic: digma-node-execution-requests, groupId: cg-digma-node-worker)","exception":{"message":"It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 723\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager.EmitConnections()\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager..ctor(RedisConfiguration redisConfiguration, ILogger`1 logger)\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisClientFactory..ctor(IEnumerable`1 configurations, ILoggerFactory loggerFactory, ISerializer serializer)\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Span`1& arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)\n   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)\n   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.IServiceCollectionExtensions.<>c__2`1.<AddStackExchangeRedisExtensions>b__2_1(IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at KafkaFlow.MicrosoftDependencyResolver.Resolve(Type type)\n   at KafkaFlow.MiddlewareExecutor.CreateInstance(IDependencyResolver dependencyResolver, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass8_0.<GetConsumerOrProducerInstance>b__0(Int32 _)\n   at KafkaFlow.DictionaryExtensions.SafeGetOrAdd[TKey,TValue](IDictionary`2 dictionary, TKey key, Func`2 addFactory)\n   at KafkaFlow.MiddlewareExecutor.GetConsumerOrProducerInstance(IDependencyResolver dependencyResolver, Int32 index, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ResolveInstance(IDependencyResolver dependencyResolver, Int32 index, IMessageContext context, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ExecuteDefinition(Int32 index, IDependencyResolver dependencyResolver, IMessageContext context, Func`2 nextOperation)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass6_0.<ExecuteDefinition>b__0(IMessageContext nextContext)\n   at Digma.Common.Kafka.Middlewares.KafkaErrorHandlingMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/Middlewares/KafkaErrorHandlingMiddleware.cs:line 19","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-26T14:45:21.8463222","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-8855487bd-hpwz6"},{"message":"2024/07/26 14:43:31.667 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:43:31.6672788","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:38:31.438 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:38:31.4380706","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:33:31.360 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:33:31.3607973","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:27:33.400 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:27:33.4001542","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:22:31.173 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:22:31.1735825","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:17:30.751 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:17:30.7510826","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:12:30.348 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:12:30.3481871","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:07:29.736 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:07:29.7364581","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 14:02:29.648 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T14:02:29.6485772","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:57:27.655 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:57:27.6550994","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:52:26.706 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:52:26.7069582","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:47:25.946 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:47:25.9467194","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:41:26.959 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:41:26.9599687","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:36:25.918 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:36:25.9188657","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:30:24.886 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:30:24.8862966","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:24:25.647 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:24:25.6474632","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:19:24.703 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:19:24.7039903","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:14:24.632 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:14:24.6323971","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:09:24.537 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:09:24.5377762","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 13:04:24.436 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T13:04:24.4366642","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:59:24.301 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:59:24.3015354","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:54:24.214 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:54:24.2141106","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:48:25.138 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:48:25.1385095","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:42:24.923 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:42:24.9236022","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:37:24.522 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:37:24.5227298","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:32:23.894 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:32:23.8942613","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:27:23.296 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:27:23.2968734","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:22:22.865 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:22:22.8658258","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:16:22.574 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:16:22.5747374","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:11:22.101 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:11:22.1013372","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:06:21.303 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:06:21.3034357","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 12:01:20.309 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T12:01:20.3092911","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:56:20.197 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:56:20.197649","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:50:20.567 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:50:20.5678827","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:44:20.880 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:44:20.8801662","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:39:19.909 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:39:19.909748","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:34:19.821 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:34:19.8216197","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:29:18.857 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:29:18.8576597","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:24:16.386 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:24:16.3865166","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:18:15.783 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:18:15.7831432","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:13:14.402 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:13:14.4027048","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:08:14.309 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:08:14.3098692","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 11:03:13.489 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T11:03:13.4894535","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:57:14.296 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:57:14.2969548","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:52:12.925 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:52:12.9251516","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:47:12.871 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:47:12.8716734","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:41:13.261 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:41:13.2619199","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:35:13.376 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:35:13.3763495","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:30:11.597 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:30:11.597057","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:25:10.658 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:25:10.6588169","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:19:09.702 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:19:09.7020687","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:14:08.871 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:14:08.8712505","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:08:08.874 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:08:08.8747506","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:07:09.112 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointChattyApiInsightNode' failed with an error","exception":{"message":"Sequence contains more than one element","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()\n   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)\n   at Digma.Common.CodeObjectInsightsRepository.GetSpecific(Guid accountId, String environment, String codeObjectId, String insightType) in /src/Core/Digma.Common/CodeObjectInsightsRepository.cs:line 296\n   at Digma.Insight.Analysis.ExecutionNodes.Common.CommonInsightJobHelpers.PossiblyDeactivateInsight(Guid accountId, String environment, String spanCodeObjectId, Nullable`1 customStartTime, String classification) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/Common/CommonInsightJobHelpers.cs:line 34\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointChattyApiInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointChattyApiInsightNode.cs:line 66\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:07:09.1120233","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:06:09.590 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:06:09.5900556","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 10:01:07.928 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T10:01:07.928806","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:56:07.229 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:56:07.2299389","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:51:06.821 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:51:06.8215253","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:46:05.820 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:46:05.8201389","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:41:04.888 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:41:04.8886991","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:36:04.805 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:36:04.8057764","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 09:32:04.464 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointChattyApiInsightNode' failed with an error","exception":{"message":"Sequence contains more than one element","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()\n   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)\n   at Digma.Common.CodeObjectInsightsRepository.GetSpecific(Guid accountId, String environment, String codeObjectId, String insightType) in /src/Core/Digma.Common/CodeObjectInsightsRepository.cs:line 296\n   at Digma.Insight.Analysis.ExecutionNodes.Common.CommonInsightJobHelpers.PossiblyDeactivateInsight(Guid accountId, String environment, String spanCodeObjectId, Nullable`1 customStartTime, String classification) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/Common/CommonInsightJobHelpers.cs:line 34\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointChattyApiInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointChattyApiInsightNode.cs:line 66\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T09:32:04.464515","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:32:53.798 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:32:53.7980852","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:27:53.206 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:27:53.2069734","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:22:50.212 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:22:50.2128328","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:17:47.687 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:17:47.6873372","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:12:46.830 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:12:46.830613","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:07:45.178 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:07:45.1783557","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 08:02:44.258 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T08:02:44.2582735","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:57:44.174 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:57:44.174555","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:52:43.522 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:52:43.5226402","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:47:42.271 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:47:42.2710733","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:42:42.169 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:42:42.1697722","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:37:41.551 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:37:41.5517823","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:32:41.483 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:32:41.4834639","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:27:41.387 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:27:41.3878297","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:22:41.304 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:22:41.3042372","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:17:41.202 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:17:41.2029725","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:12:40.295 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:12:40.2950716","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:07:39.171 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:07:39.1719271","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 07:02:39.060 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T07:02:39.0608347","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:57:38.428 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:57:38.4286696","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:52:38.347 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:52:38.3474045","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:47:38.242 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:47:38.2423499","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:42:37.967 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:42:37.9675917","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:37:37.189 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:37:37.1894982","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:32:35.187 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:32:35.1877244","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:27:34.549 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:27:34.549822","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:22:34.460 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:22:34.4602386","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:17:34.368 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:17:34.3680608","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:12:34.277 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:12:34.277901","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:07:34.203 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:07:34.2036525","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 06:02:33.223 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T06:02:33.2230808","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:57:32.358 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:57:32.3586505","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:52:32.269 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:52:32.2698168","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:47:32.192 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:47:32.1920799","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:42:30.220 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:42:30.2207065","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:37:29.643 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:37:29.6431119","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:32:29.562 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:32:29.5627022","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:27:29.480 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:27:29.4806504","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:21:30.784 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:21:30.7843756","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:16:29.301 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:16:29.3013511","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:11:28.934 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:11:28.9343898","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:05:27.856 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:05:27.8567378","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 05:00:25.351 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T05:00:25.3513158","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:55:24.932 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:55:24.9325763","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:50:24.829 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:50:24.8299816","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:45:24.756 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:45:24.7563525","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:39:25.604 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:39:25.6049534","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:34:24.357 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:34:24.3576036","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:28:24.584 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:28:24.584811","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:23:23.630 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:23:23.6307875","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:17:24.862 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:17:24.8627539","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:12:23.844 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:12:23.8440055","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:07:23.284 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:07:23.284197","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 04:02:22.989 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T04:02:22.9899133","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:56:23.483 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:56:23.48324","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:50:24.919 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:50:24.919854","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:44:23.129 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:44:23.1299449","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:38:24.300 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:38:24.300468","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:33:22.689 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:33:22.6895216","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:27:23.331 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:27:23.3315233","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:21:22.182 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:21:22.1821657","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:16:21.893 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:16:21.8932581","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:11:21.357 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:11:21.3577487","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:06:21.181 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:06:21.1819883","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 03:01:20.071 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T03:01:20.0710105","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:56:19.590 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:56:19.5901588","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:50:19.784 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:50:19.7847852","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:45:19.468 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:45:19.4688708","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:40:19.343 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:40:19.343524","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:35:19.266 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:35:19.2662464","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:30:19.180 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:30:19.1808271","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:25:18.592 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:25:18.5928981","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:20:18.517 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:20:18.5178953","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:15:18.438 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:15:18.4386156","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:09:18.361 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:09:18.3615043","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 02:04:18.290 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T02:04:18.2901081","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:59:18.192 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:59:18.1925551","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:54:15.569 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:54:15.5690715","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:49:15.488 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:49:15.4886482","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:43:16.482 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:43:16.4821836","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:38:14.585 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:38:14.5854694","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:33:13.918 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:33:13.9183997","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:27:14.671 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:27:14.6713661","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:21:13.983 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:21:13.9832501","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:16:13.907 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:16:13.9078044","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:11:13.633 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:11:13.6336212","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:06:13.326 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:06:13.326676","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 01:01:12.704 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T01:01:12.7047884","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:56:11.881 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:56:11.8813733","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:51:11.174 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:51:11.1741297","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:46:10.402 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:46:10.4022415","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:41:10.322 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:41:10.3221295","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:36:10.223 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:36:10.223487","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:31:10.150 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:31:10.1503575","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:26:09.165 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:26:09.1654685","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:21:08.868 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:21:08.8686333","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:16:08.176 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:16:08.1769835","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:11:06.137 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:11:06.1373523","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:05:06.883 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:05:06.8837771","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/26 00:00:05.136 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-26T00:00:05.1369387","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:55:03.711 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:55:03.7119987","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:50:03.625 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:50:03.6259427","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:45:03.011 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:45:03.0119085","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:40:02.931 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:40:02.9314458","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:34:03.389 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:34:03.3899969","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:29:51.923 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T23:29:51.9231814","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:29:01.618 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:29:01.6180117","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:24:01.350 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:24:01.3502873","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:18:03.094 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:18:03.0944413","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:13:01.160 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:13:01.1601219","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:11:48.575 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T23:11:48.5755279","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:08:01.066 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:08:01.0663028","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 23:03:00.058 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T23:03:00.0581194","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:57:58.659 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:57:58.6592849","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:52:58.585 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:52:58.5859459","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:47:57.770 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:47:57.7704788","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:42:57.687 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:42:57.6876715","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:37:57.609 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:37:57.6099871","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:32:55.939 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:32:55.9394298","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:27:55.758 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:27:55.7588142","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:22:55.677 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:22:55.6779321","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:17:55.593 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:17:55.593083","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:12:54.518 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:12:54.5185219","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:07:54.442 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:07:54.4422564","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 22:02:53.076 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T22:02:53.076652","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:57:52.776 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:57:52.7766192","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:52:51.874 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:52:51.8745034","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:47:51.792 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:47:51.7929092","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:42:50.753 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:42:50.7530252","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:37:49.802 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:37:49.8020901","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:32:49.718 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:32:49.7187735","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:27:49.544 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:27:49.5440646","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 21:22:49.432 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T21:22:49.4321256","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 20:18:39.736 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T20:18:39.7361692","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 20:13:38.591 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T20:13:38.5915327","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 20:08:38.070 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T20:08:38.0702869","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 20:03:36.833 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T20:03:36.833471","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:58:36.810 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:58:36.8106297","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:53:36.281 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:53:36.2812509","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:47:36.345 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:47:36.3459233","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:41:35.582 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:41:35.5821107","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:36:32.430 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:36:32.4306871","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:31:31.449 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:31:31.4496936","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:26:31.354 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:26:31.3549053","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:21:30.686 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:21:30.6864449","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:15:31.765 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:15:31.7654498","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:10:31.071 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:10:31.0716079","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:05:30.430 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:05:30.430417","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 19:00:30.295 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T19:00:30.2958267","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:54:30.864 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:54:30.8644933","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:49:30.734 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:49:30.734614","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:43:30.733 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:43:30.7335921","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:38:28.010 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:38:28.0102504","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:33:26.958 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:33:26.9587972","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:29:49.185 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T18:29:49.1859966","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:29:48.931 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T18:29:48.9312214","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:29:48.831 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T18:29:48.8312818","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:29:48.220 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T18:29:48.2204603","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:28:26.657 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:28:26.6574591","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:23:26.553 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:23:26.5532736","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:18:26.459 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:18:26.4593191","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:12:26.779 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:12:26.7795094","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:10:44.760 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T18:10:44.7607913","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:06:26.036 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:06:26.0368885","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 18:00:26.055 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T18:00:26.0554969","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:55:25.387 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:55:25.3873878","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:50:40.267 Error [.NET ThreadPool Worker] Digma.Common.Repositories.SpanDurationPercentilesRepository - No entities to insert into SpanDurationPercentiles","exception":null,"details":"","timestamp":"2024-07-25T17:50:40.2673768","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:50:25.263 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:50:25.2632951","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:44:25.375 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:44:25.3757641","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:39:23.860 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:39:23.8603329","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:34:23.771 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:34:23.7718497","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:28:23.975 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:28:23.9756502","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:23:23.592 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:23:23.5921304","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:18:23.488 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:18:23.48814","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 17:12:23.795 Error [.NET ThreadPool Worker] Digma.Pipeline.Executor.PipelineExecutor - 'EndpointDurationSlowdownSourceInsightNode' failed with an error","exception":{"message":"Sequence contains no elements","type":"System.InvalidOperationException","stackTrace":"   at System.Linq.ThrowHelper.ThrowNoElementsException()\n   at System.Linq.Enumerable.Max[TSource](IEnumerable`1 source, Func`2 selector)\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.CreateGraph(Guid rootId, ICollection`1 relations, Func`2 getDurationChange) in /src/Services/Analytics/Digma.Insight.Analysis/Analyzers/DurationSlowdownAnalyzer.cs:line 171\n   at Digma.Insight.Analysis.Analyzers.DurationSlowdownAnalyzer.IdentifyDurationSlowDownRootCauses(Guid accountId, String environment, String spanCodeObjectId, DateTime startTime)\n   at Digma.Insight.Analysis.ExecutionNodes.EndpointDurationSlowdownSourceInsightNode.Consume(Guid accountId, EndpointData payload) in /src/Services/Analytics/Digma.Insight.Analysis/ExecutionNodes/EndpointDurationSlowdownSourceInsightNode.cs:line 52\n   at Digma.Pipeline.Executor.PipelineExecutor.<>c__DisplayClass11_0.<<ExecuteInternal>b__1>d.MoveNext() in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 131\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()\n--- End of stack trace from previous location ---\n   at Polly.ResiliencePipeline.ExecuteAsync(Func`2 callback, CancellationToken cancellationToken)\n   at Digma.Pipeline.Executor.PipelineExecutor.ExecuteInternal(IExecutionNode node, IPipelineContext context, CancellationToken cancellationToken) in /src/Services/Pipeline/Digma.Pipeline/Executor/PipelineExecutor.cs:line 143","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-25T17:12:23.7957234","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/25 16:50:28.030 Error [.NET ThreadPool Worker] KafkaConsumer - Error occurred while processing message (topic: digma-pipeline-execution-requests, groupId: cg-digma-pipeline-worker)","exception":{"message":"It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 723\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager.EmitConnections()\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager..ctor(RedisConfiguration redisConfiguration, ILogger`1 logger)\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisClientFactory..ctor(IEnumerable`1 configurations, ILoggerFactory loggerFactory, ISerializer serializer)\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Span`1& arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)\n   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)\n   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.IServiceCollectionExtensions.<>c__2`1.<AddStackExchangeRedisExtensions>b__2_1(IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at KafkaFlow.MicrosoftDependencyResolver.Resolve(Type type)\n   at KafkaFlow.MiddlewareExecutor.CreateInstance(IDependencyResolver dependencyResolver, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass8_0.<GetConsumerOrProducerInstance>b__0(Int32 _)\n   at KafkaFlow.DictionaryExtensions.SafeGetOrAdd[TKey,TValue](IDictionary`2 dictionary, TKey key, Func`2 addFactory)\n   at KafkaFlow.MiddlewareExecutor.GetConsumerOrProducerInstance(IDependencyResolver dependencyResolver, Int32 index, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ResolveInstance(IDependencyResolver dependencyResolver, Int32 index, IMessageContext context, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ExecuteDefinition(Int32 index, IDependencyResolver dependencyResolver, IMessageContext context, Func`2 nextOperation)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass6_0.<ExecuteDefinition>b__0(IMessageContext nextContext)\n   at Digma.Common.Kafka.Middlewares.KafkaErrorHandlingMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/Middlewares/KafkaErrorHandlingMiddleware.cs:line 19","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-25T16:50:28.0305452","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-5c46c9f6f7-j5cr9"},{"message":"2024/07/24 14:51:21.215 Error [.NET ThreadPool Worker] KafkaConsumer - Error occurred while processing message (topic: digma-pipeline-execution-requests, groupId: cg-digma-pipeline-worker)","exception":{"message":"It was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until it's able to connect, use abortConnect=false in your connection string or AbortOnConnectFail=false; in your code.","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.ConnectImpl(ConfigurationOptions configuration, TextWriter writer, Nullable`1 serverType, EndPointCollection endpoints) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 723\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager.EmitConnections()\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager..ctor(RedisConfiguration redisConfiguration, ILogger`1 logger)\n   at StackExchange.Redis.Extensions.Core.Implementations.RedisClientFactory..ctor(IEnumerable`1 configurations, ILoggerFactory loggerFactory, ISerializer serializer)\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Span`1& arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)\n   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)\n   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.IServiceCollectionExtensions.<>c__2`1.<AddStackExchangeRedisExtensions>b__2_1(IServiceProvider provider)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)\n   at KafkaFlow.MicrosoftDependencyResolver.Resolve(Type type)\n   at KafkaFlow.MiddlewareExecutor.CreateInstance(IDependencyResolver dependencyResolver, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass8_0.<GetConsumerOrProducerInstance>b__0(Int32 _)\n   at KafkaFlow.DictionaryExtensions.SafeGetOrAdd[TKey,TValue](IDictionary`2 dictionary, TKey key, Func`2 addFactory)\n   at KafkaFlow.MiddlewareExecutor.GetConsumerOrProducerInstance(IDependencyResolver dependencyResolver, Int32 index, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ResolveInstance(IDependencyResolver dependencyResolver, Int32 index, IMessageContext context, MiddlewareConfiguration configuration)\n   at KafkaFlow.MiddlewareExecutor.ExecuteDefinition(Int32 index, IDependencyResolver dependencyResolver, IMessageContext context, Func`2 nextOperation)\n   at KafkaFlow.MiddlewareExecutor.<>c__DisplayClass6_0.<ExecuteDefinition>b__0(IMessageContext nextContext)\n   at Digma.Common.Kafka.Middlewares.KafkaErrorHandlingMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/Middlewares/KafkaErrorHandlingMiddleware.cs:line 19","source":"StackExchange.Redis","innerException":null},"details":"","timestamp":"2024-07-24T14:51:21.2159042","application":"Pipeline.Worker","instacneId":"digma-pipeline-worker-deployment-9b756886f-hw6hk"},{"message":"2024/07/31 06:12:24.571 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:12:24.571032","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:12:22.737 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:12:22.7378009","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:12:21.871 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error TryConnect","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at Pipelines.Sockets.Unofficial.Arenas.ArrayPoolAllocator`1.Allocate(Int32 length) in /_/src/Pipelines.Sockets.Unofficial/Arenas/Allocator.cs:line 51\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1.AllocateAndAttachBlock(Block`1 previous) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 190\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator, Int32 blockSizeBytes) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 184\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 156\n   at StackExchange.Redis.PhysicalConnection..ctor(PhysicalBridge bridge) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1817\n   at StackExchange.Redis.PhysicalBridge.TryConnect(ILogger log) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 1398\n   at StackExchange.Redis.PhysicalBridge.OnDisconnected(ConnectionFailureType failureType, PhysicalConnection connection, Boolean& isCurrent, State& oldState) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 488\n   at StackExchange.Redis.PhysicalConnection.RecordConnectionFailed(ConnectionFailureType failureType, Exception innerException, String origin, Boolean isInitialConnect, IDuplexPipe connectingPipe) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 398\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1812","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:12:21.8719797","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:12:21.766 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T06:12:21.766405","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:12:14.158 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:12:14.1583036","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:11:56.932 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:11:56.9326636","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:11:24.325 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:11:24.3258532","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:11:12.771 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:11:12.7710137","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:10:53.844 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:10:53.8448755","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:10:33.751 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:10:33.7512046","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:10:33.028 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:10:33.0285398","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:10:08.146 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:10:08.1462712","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:09:55.069 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:09:55.0699708","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:09:10.336 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:09:10.3367777","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:08:57.824 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method113(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T06:08:57.8242195","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:08:52.328 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:08:52.3288003","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:08:14.641 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:08:14.6417408","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:08:10.421 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T06:08:10.4211919","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:07:50.149 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Enumerable.Iterator`1.System.Collections.IEnumerator.get_Current()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T06:07:50.1492588","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:07:24.034 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:07:24.0341105","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:07:20.246 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:07:20.2461793","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:07:17.361 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T06:07:17.3619969","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:06:25.759 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:06:25.7597015","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:06:22.073 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:06:22.073701","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:05:56.737 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:05:56.7376186","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:05:53.268 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:05:53.2687949","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:05:26.460 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:05:26.4606555","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:05:23.525 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:05:23.525666","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:04:59.140 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:04:59.1407803","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:04:55.371 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:04:55.3710495","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:04:52.063 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:04:52.0631939","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:04:10.621 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:04:10.6211299","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:03:45.475 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:03:45.4756577","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:03:44.749 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:03:44.7495701","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:03:40.164 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:03:40.1644112","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:02:27.536 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T06:02:27.5365032","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:02:27.536 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:02:27.5365032","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:02:22.878 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:02:22.8780912","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:02:02.257 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:02:02.257244","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:35.325 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:35.3256474","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:34.025 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateOpenTelemetry.Proto.Trace.V1.Status()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T06:01:34.0251267","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:28.565 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:28.5659218","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:22.250 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:22.2509048","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:06.235 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:06.2352704","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:05.360 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:05.3608407","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:01:00.972 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:01:00.9721317","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:00:49.471 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:00:49.4715388","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:00:39.669 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:00:39.669177","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:00:24.626 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:00:24.6263771","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 06:00:02.829 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T06:00:02.8297461","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:59:50.842 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:59:50.8420168","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:58:57.074 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.Collections.RepeatedField`1.SetSize(Int32 size)\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-31T05:58:57.0740725","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:58:13.154 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:58:13.1546584","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:58:12.953 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:58:12.9533818","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:57:27.149 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:57:27.1497802","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:57:03.754 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:57:03.75434","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:57:00.942 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:57:00.9424767","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:56:41.547 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:56:41.5476175","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:56:24.349 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:56:24.3494517","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:57.357 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:57.3572783","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:56.926 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:56.9266409","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:56.270 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:55:56.2705773","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:50.430 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:50.43088","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:38.453 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:38.4532413","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:35.946 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:35.9469412","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:34.541 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:34.5411836","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:30.622 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:30.6220827","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:55:17.276 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:55:17.2763456","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:54:49.171 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Timeout awaiting response (outbound=0KiB, inbound=32040KiB, 5328ms elapsed, timeout is 5000ms), command=GET, next: GET Trace:52DF1D52F3011593150C6400D8675E60:Data, inst: 0, qu: 0, qs: 3, aw: False, bw: SpinningDown, rs: TryParseResult, ws: Idle, in: 3679738, in-pipe: 802816, out-pipe: 0, last-in: 42977394, cur-in: 40100529, sync-ops: 0, async-ops: 6175, serverEndpoint: digma-redis:6379, conn-sec: 50079.63, aoc: 1, mc: 1/1/0, mgr: 0 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-nh8pl(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=10,Free=32757,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=0,CompletedItems=4414815,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:54:49.1718145","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:54:40.742 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 3 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.881[0].Spans[1].Attributes[0].Value.Type', line 1, position 6714298.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Enum.InternalBoxEnum(RuntimeType enumType, Int64 value)\n   at System.Enum.ToObject(Type enumType, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-31T05:54:40.7420288","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:54:36.323 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.ByteString.FromBase64(String bytes)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-31T05:54:36.3239534","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:53:34.164 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:53:34.1646123","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:53:20.944 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:53:20.9443529","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:53:16.566 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:53:16.5666332","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:51:49.227 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:51:49.227417","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:51:26.419 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:51:26.4199813","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/31 05:45:20.736 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:45:20.7363094","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:45:16.560 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)\n   at System.Collections.Generic.Dictionary`2.System.Collections.IDictionary.set_Item(Object key, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:45:16.5608239","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:45:16.560 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error TryConnect","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at Pipelines.Sockets.Unofficial.Arenas.ArrayPoolAllocator`1.Allocate(Int32 length) in /_/src/Pipelines.Sockets.Unofficial/Arenas/Allocator.cs:line 51\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1.AllocateAndAttachBlock(Block`1 previous) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 190\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator, Int32 blockSizeBytes) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 184\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 156\n   at StackExchange.Redis.PhysicalConnection..ctor(PhysicalBridge bridge) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1817\n   at StackExchange.Redis.PhysicalBridge.TryConnect(ILogger log) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 1398\n   at StackExchange.Redis.PhysicalBridge.OnDisconnected(ConnectionFailureType failureType, PhysicalConnection connection, Boolean& isCurrent, State& oldState) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 488\n   at StackExchange.Redis.PhysicalConnection.RecordConnectionFailed(ConnectionFailureType failureType, Exception innerException, String origin, Boolean isInitialConnect, IDuplexPipe connectingPipe) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 398\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1812","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:45:16.5608239","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:43.661 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:43.6615017","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:42.729 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:42.7293146","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:40.325 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:40.3250566","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:21.029 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:21.0298363","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:20.253 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:20.2531616","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:17.451 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:44:17.4514803","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:44:16.335 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:44:16.3350686","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:43:38.121 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:43:38.1213864","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:43:37.643 Error [.NET Long Running Task] Digma.Collector.Services.UnhandledTraceProcessing.LogUnhandledTraceProcessingService - Fail to process trace 28A87EC627586A51081A0ABED9A67DA6 with 16 spans","exception":{"message":"One or more errors occurred. (Exception of type 'System.OutOfMemoryException' was thrown.)","type":"System.Exception","stackTrace":"   at Digma.Collector.Services.SpanMeasurementMessageProducer.Produce(IReadOnlyCollection`1 messages) in /src/ApiGateways/Digma.Collector/Services/ISpanMeasurementMessageProducer.cs:line 45\n   at Digma.Collector.Services.TraceProcessor.AddOrUpdateRootedSpanMeasurements(SpanGraph previousGraph, SpanGraph updatedGraph, Guid accountId, String environment, TraceScopesContainer traceScopesContainer, SpanErrorNode[] updatedErrors) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 866\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 392\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164","source":"Digma.Collector","innerException":null},"details":"","timestamp":"2024-07-31T05:43:37.6432455","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:42:17.868 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:42:17.868224","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:42:12.132 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:42:12.1327017","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:41:54.220 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:41:54.2203241","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:41:51.368 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T05:41:51.3684423","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:41:32.146 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:41:32.1464352","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:41:31.555 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:41:31.5550835","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:40:37.764 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:40:37.7648552","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:40:22.166 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:40:22.166307","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:40:07.671 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:40:07.6712496","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:39:52.372 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:39:52.3722088","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:39:51.047 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:39:51.0476236","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:39:07.276 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:39:07.2766536","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:38:07.942 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:38:07.942151","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:37:54.554 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:37:54.554936","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:37:48.838 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:37:48.8382041","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:37:47.571 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at OpenTelemetry.Proto.Trace.V1.Span..ctor() in /src/Core/Digma.Common/obj/Release/net6.0/opentelemetry/proto/trace/v1/Trace.cs:line 863\n   at CreateOpenTelemetry.Proto.Trace.V1.Span()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:37:47.5718878","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:37:28.061 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:37:28.0613479","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:37:07.630 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5219533, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)\n   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)\n   at Pipelines.Sockets.Unofficial.SocketConnection.WrappedReader.ReadAsync(CancellationToken cancellationToken) in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.cs:line 402\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T05:37:07.6307471","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:36:50.231 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:36:50.2318553","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:36:47.739 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:36:47.7391775","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:36:22.425 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:36:22.4258231","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:36:02.072 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Enumerable.Iterator`1.System.Collections.IEnumerator.get_Current()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T05:36:02.0720564","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:35:48.768 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:35:48.7682401","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:35:47.343 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:35:47.3436722","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:35:45.231 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:35:45.2310426","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:35:42.969 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:35:42.9695278","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:35:41.329 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:35:41.3295469","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:34:40.521 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:34:40.5216129","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:34:18.221 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:34:18.2211253","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:33:54.765 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.2509[1].Spans[4].Attributes[7].Value.Type', line 1, position 20528329.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T05:33:54.7658166","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:33:24.877 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:33:24.8777795","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:32:19.268 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:32:19.2689405","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:32:02.358 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:32:02.3588576","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:31:41.363 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:31:41.3631746","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:31:25.267 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:31:25.2673752","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:31:21.877 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WriteEnd(JsonToken token)\n   at Newtonsoft.Json.JsonWriter.AutoCompleteClose(JsonContainerType type)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:31:21.8771377","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:30:57.573 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:30:57.5734917","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:30:55.125 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:30:55.1258446","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:29:48.033 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:29:48.0337181","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:29:47.367 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:29:47.3671101","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:29:42.558 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:29:42.5583347","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:29:26.941 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:29:26.9413785","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:29:09.751 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:29:09.751672","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:27:38.457 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:27:38.4572489","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:27:35.344 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:27:35.3446915","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:27:15.030 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:27:15.0303591","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:51.626 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:26:51.6263322","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:50.821 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:26:50.8217683","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:34.035 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 1s ago, unanswered-write: 1s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5249541, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.GetReadAsyncResult()\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T05:26:34.0354208","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:33.823 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:26:33.8232267","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:33.823 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:26:33.8232267","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:26:09.456 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:26:09.4569642","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:25:52.330 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:25:52.3304021","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:25:51.956 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:25:51.9569438","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:25:50.351 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:25:50.3519804","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:25:32.448 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:25:32.4483846","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:25:02.041 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:25:02.0415816","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:24:44.834 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:24:44.8347769","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:24:44.633 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:24:44.6336972","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:24:43.461 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:24:43.4614381","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:24:29.525 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:24:29.5251357","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:24:22.754 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 3 to type 'OpenTelemetry.Proto.Trace.V1.Span+Types+SpanKind'. Path 'VersionedSpanContainers.1100[0].Spans[4].Kind', line 1, position 8459355.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T05:24:22.7548669","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:23:46.223 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.SpanContainer()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:23:46.2237386","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:23:24.370 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:23:24.3702997","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:23:01.455 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:23:01.4550985","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:22:42.456 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:22:42.4565835","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:22:29.949 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:22:29.9494694","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:22:14.666 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:22:14.6664165","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:22:00.833 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:22:00.8330129","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:21:55.337 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:21:55.3370517","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:21:31.479 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:21:31.4790692","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:20:23.057 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:20:23.0573785","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:20:15.139 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:20:15.1398005","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:20:14.240 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:20:14.2404488","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:19:24.466 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:19:24.4664032","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:19:10.449 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:19:10.4496495","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:18:21.233 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:18:21.2332517","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:17:54.944 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:17:54.9446135","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:17:49.427 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:17:49.4278137","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:17:27.842 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:17:27.8422786","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:17:26.640 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:17:26.6409985","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:17:24.720 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:17:24.7208593","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:16:38.567 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:16:38.5674494","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:16:20.746 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonWriter.AutoComplete(JsonToken tokenBeingWritten)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:16:20.7466322","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:16:05.568 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:16:05.568685","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:16:03.979 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:16:03.9794142","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:15:42.657 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 1s ago, unanswered-write: 1s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5207408, in-pipe: 0, out-pipe: 0, last-heartbeat: 1s ago, last-mbeat: 1s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)\n   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)\n   at Pipelines.Sockets.Unofficial.SocketConnection.WrappedReader.ReadAsync(CancellationToken cancellationToken) in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.cs:line 402\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.IO.Pipelines.Pipe.CreateSegmentUnsynchronized()\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.IO.Pipelines","innerException":null}}},"details":"","timestamp":"2024-07-31T05:15:42.6575694","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:15:26.277 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:15:26.2778194","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:15:22.626 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T05:15:22.626176","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:15:19.657 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:15:19.6574802","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:52.748 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:14:52.748212","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:31.637 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:14:31.637078","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:28.841 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:14:28.8410129","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:27.455 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Utilities.BoxedPrimitives.Get(Int64 value)\n   at Newtonsoft.Json.JsonTextReader.ParseReadNumber(ReadType readType, Char firstChar, Int32 initialPosition)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T05:14:27.4557483","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:23.972 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:14:23.9726964","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:14:03.047 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:14:03.0475431","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:13:44.779 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:13:44.779577","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:13:24.877 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:13:24.8775371","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:13:08.059 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:13:08.0597984","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:13:07.451 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:13:07.4511943","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:12:37.429 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:12:37.4298647","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:12:26.244 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method131(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T05:12:26.2448072","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:12:11.327 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:12:11.3272116","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:12:06.165 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:12:06.1659864","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:11:49.227 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:11:49.2275789","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:11:20.146 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:11:20.146567","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:10:54.454 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:10:54.4540195","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:10:31.064 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:10:31.0648776","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:10:28.644 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:10:28.6444753","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:10:11.473 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:10:11.4734052","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:09:54.030 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:09:54.0302556","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:09:37.468 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 0 to type 'System.UInt32'. Path 'VersionedSpanContainers.2582[0].Spans[1].DroppedAttributesCount', line 1, position 21483802.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-31T05:09:37.4689689","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:09:14.243 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:09:14.2434126","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:09:13.851 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:09:13.8513046","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:09:13.343 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5095001, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.GetReadAsyncResult()\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T05:09:13.3433259","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:08:44.850 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:08:44.8500622","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:08:34.249 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:08:34.2494275","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:08:09.042 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:08:09.0425106","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:07:23.039 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method131(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T05:07:23.0392006","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:07:21.220 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:07:21.2207101","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:06:32.853 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:06:32.8534186","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:06:02.549 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:06:02.5491548","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:05:35.020 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:05:35.0201746","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:05:34.021 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:05:34.0210876","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:05:11.640 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:05:11.6406293","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:05:06.628 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:05:06.628817","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:04:48.163 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:04:48.1636873","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:04:23.248 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:04:23.2481261","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:04:20.837 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.841[0].Spans[4].Attributes[7].Value.Type', line 1, position 6543682.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Enum.InternalBoxEnum(RuntimeType enumType, Int64 value)\n   at System.Enum.ToObject(Type enumType, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-31T05:04:20.8379448","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:03:55.662 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:03:55.6622822","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:03:41.575 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:03:41.5750868","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:03:36.376 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:03:36.376432","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:03:22.220 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:03:22.2204091","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:03:16.858 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:03:16.8580284","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:46.920 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T05:02:46.9206933","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:40.733 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:02:40.7336775","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:25.948 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:02:25.9480282","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:20.473 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:02:20.4736945","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:06.434 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:02:06.4341405","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:02:00.653 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:02:00.6539837","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:01:35.953 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:01:35.953","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:01:15.359 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:01:15.3590729","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:00:54.927 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:00:54.9276932","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:00:29.664 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T05:00:29.6646122","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:00:18.162 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:00:18.1625369","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 05:00:13.533 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T05:00:13.5333276","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:59:54.123 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:59:54.1237316","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:59:06.044 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:59:06.0445896","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:41.472 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:58:41.4728481","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:31.356 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:58:31.3560627","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:30.347 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:58:30.3471982","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:13.533 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:58:13.5339282","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:11.422 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.3320[0].Spans[2].Attributes[1].Value.Type', line 1, position 27822414.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T04:58:11.4225738","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:58:08.573 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:58:08.573252","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:57:54.738 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:57:54.7385279","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:57:53.120 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:57:53.1208352","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:57:05.073 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:57:05.0734712","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:57:04.056 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.System.Collections.IEnumerable.GetEnumerator()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:57:04.05655","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:56:24.641 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:56:24.6412944","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:56:23.236 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:56:23.2368274","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:56:08.059 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:56:08.0591062","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:56:04.120 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:56:04.1208799","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:55:28.351 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:55:28.3516757","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:55:22.350 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:55:22.350972","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:55:13.022 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:55:13.0227741","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:55:06.547 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:55:06.5471936","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:54:53.958 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:54:53.9585337","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:54:23.652 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Collection was modified; enumeration operation may not execute.","exception":{"message":"Collection was modified; enumeration operation may not execute.","type":"System.InvalidOperationException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:54:23.6521649","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:54:04.363 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:54:04.3632863","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:53:59.532 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:53:59.5321774","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/31 04:47:59.157 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:47:59.1578451","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:47:45.637 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:47:45.6378433","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:47:45.233 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error TryConnect","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at Pipelines.Sockets.Unofficial.Arenas.ArrayPoolAllocator`1.Allocate(Int32 length) in /_/src/Pipelines.Sockets.Unofficial/Arenas/Allocator.cs:line 51\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1.AllocateAndAttachBlock(Block`1 previous) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 190\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator, Int32 blockSizeBytes) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 184\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 156\n   at StackExchange.Redis.PhysicalConnection..ctor(PhysicalBridge bridge) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1817\n   at StackExchange.Redis.PhysicalBridge.TryConnect(ILogger log) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 1398\n   at StackExchange.Redis.PhysicalBridge.OnDisconnected(ConnectionFailureType failureType, PhysicalConnection connection, Boolean& isCurrent, State& oldState) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 488\n   at StackExchange.Redis.PhysicalConnection.RecordConnectionFailed(ConnectionFailureType failureType, Exception innerException, String origin, Boolean isInitialConnect, IDuplexPipe connectingPipe) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 398\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1812","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:47:45.2337587","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:46:44.846 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:46:44.8464984","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:46:39.167 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:46:39.1670933","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:46:23.018 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method116(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T04:46:23.0182734","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:46:17.547 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:46:17.5470707","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:46:00.655 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:46:00.6559743","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:45:37.940 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:45:37.9406489","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:45:16.556 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:45:16.5569058","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:48.041 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:44:48.0415122","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:46.327 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:44:46.327117","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:31.727 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:44:31.7273756","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:26.216 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:44:26.216683","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:07.839 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:44:07.8398485","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:06.565 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:44:06.565867","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:44:05.139 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: SETEX, origin: ReadFromPipe, outstanding: 2, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5716956, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at Digma.Common.TraceTempStorage.SetTraceProcessVersion(String traceId, Int32 version) in /src/Core/Digma.Common/TraceTempStorage.cs:line 71\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 402\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)\n   at Digma.Collector.Consumers.TraceProcessingConsumer.Handle(TraceToProcessMessage message) in /src/ApiGateways/Digma.Collector/Consumers/TraceProcessingConsumer.cs:line 60\n   at Digma.Collector.Consumers.TraceProcessingConsumer.Handle(IMessageContext context, TraceToProcessMessage message) in /src/ApiGateways/Digma.Collector/Consumers/TraceProcessingConsumer.cs:line 42\n   at KafkaFlow.TypedHandler.TypedHandlerMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.SerializerConsumerMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at Digma.Common.Kafka.Middlewares.KafkaLagMeterMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/Middlewares/KafkaLagMeterMiddleware.cs:line 45\n   at Digma.Common.Kafka.Middlewares.KafkaErrorHandlingMiddleware.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/Middlewares/KafkaErrorHandlingMiddleware.cs:line 26","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)\n   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)\n   at Pipelines.Sockets.Unofficial.SocketConnection.WrappedReader.ReadAsync(CancellationToken cancellationToken) in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.cs:line 402\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T04:44:05.1398715","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:42:23.563 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:42:23.5633355","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:42:13.428 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:42:13.4287353","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:42:00.360 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:42:00.3602026","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:41:02.310 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:41:02.3100619","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:40:52.261 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:40:52.2615898","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:40:46.026 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:40:46.0261068","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:40:27.452 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:40:27.4525348","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:40:02.212 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:40:02.2128192","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:40:00.566 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T04:40:00.5663459","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:39:44.765 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.WriteJson(JsonWriter writer, AnyValue value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 97\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:39:44.7651853","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:39:26.936 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:39:26.9365207","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:39:23.021 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:39:23.0216769","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:39:03.556 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.VersionedSpanContainer.<>c__DisplayClass23_1.<GetAllSpans>b__4(Span x) in /src/Core/Digma.Common/otlp/ExportTraceServiceRequestExtensions.cs:line 148\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:39:03.5563529","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:52.337 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:38:52.3375446","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:36.015 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:38:36.0152516","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:34.841 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:38:34.8417747","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:32.540 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:38:32.5406494","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:14.759 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)\n   at System.Collections.Generic.Dictionary`2.System.Collections.IDictionary.set_Item(Object key, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:38:14.75937","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:38:07.544 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:38:07.5447837","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:37:54.659 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:37:54.6599825","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:37:33.447 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:37:33.4476779","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:37:31.863 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.1069[0].Spans[1].Attributes[2].Value.Type', line 1, position 8279258.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T04:37:31.8639441","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:36:58.228 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:36:58.2289984","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:36:31.432 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:36:31.4324637","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:36:28.815 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:36:28.8151899","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:36:13.810 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:36:13.8105092","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:36:08.263 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.WriteJson(JsonWriter writer, AnyValue value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 97\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:36:08.26338","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:35:48.450 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:35:48.4505699","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:35:12.333 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:35:12.3336565","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:35:11.725 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:35:11.7256029","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:34:06.838 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:34:06.8385483","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:34:06.155 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:34:06.1553917","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:32:50.130 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:32:50.1303394","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:32:15.364 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:32:15.3648402","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:31:35.133 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:31:35.1337466","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:31:19.425 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:31:19.4257256","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:31:19.425 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 5649257, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)\n   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)\n   at Pipelines.Sockets.Unofficial.SocketConnection.WrappedReader.ReadAsync(CancellationToken cancellationToken) in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.cs:line 402\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T04:31:19.4257256","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:31:19.424 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Enumerable.Select[TSource,TResult](IEnumerable`1 source, Func`2 selector)\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T04:31:19.424669","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:30:38.161 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:30:38.1617249","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:29:47.727 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:29:47.7279864","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:29:39.238 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:29:39.2382485","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:29:11.709 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T04:29:11.7096506","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:27:53.655 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:27:53.6553631","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:27:36.613 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:27:36.6136356","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:27:30.625 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:27:30.6257087","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:27:00.739 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:27:00.7390887","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:26:44.641 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:26:44.6417113","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:26:04.942 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:26:04.9427463","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:25:59.744 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:25:59.7449221","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:24:53.721 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:24:53.7218212","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:24:28.960 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:24:28.96042","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:24:12.831 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:24:12.8318827","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:23:25.430 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:23:25.430539","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:23:23.517 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.774[0].Spans[0].Attributes[9].Value.Type', line 1, position 6062878.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T04:23:23.5170548","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:23:02.110 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:23:02.1101828","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:22:05.032 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:22:05.0324887","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:21:31.445 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:21:31.4451218","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:21:27.743 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:21:27.7438921","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:21:08.058 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:21:08.0582","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:21:05.622 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T04:21:05.6224793","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:21:02.649 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:21:02.6495952","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:42.133 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:20:42.1338837","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:40.624 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method116(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T04:20:40.6243317","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:37.012 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:20:37.0123256","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:21.712 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:20:21.7128171","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:20.921 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:20:20.9218639","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:20:20.025 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:20:20.0252467","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:19:48.650 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:19:48.6509834","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:19:34.843 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:19:34.843239","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:19:30.558 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:19:30.5584806","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:19:18.060 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:19:18.0605297","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:18:57.846 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:18:57.8465713","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:18:54.745 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:18:54.7453687","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:18:21.344 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:18:21.3448209","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:18:16.746 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:18:16.7468475","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:17:12.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:17:12.6192993","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:17:06.656 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:17:06.6566014","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:16:03.551 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:16:03.5518748","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:15:58.322 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:15:58.322444","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:15:42.218 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:15:42.2181109","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:14:46.938 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:14:46.9385712","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:14:29.124 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:14:29.1244359","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:14:24.145 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at Digma.Common.otlp.ByteStringConverter.WriteJson(JsonWriter writer, ByteString value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 165\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:14:24.1454176","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:13:34.910 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:13:34.9107486","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:13:02.829 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:13:02.829362","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:12:50.538 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:12:50.5389855","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:12:45.967 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:12:45.9676838","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:12:30.249 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:12:30.2497626","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:12:29.933 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:12:29.9333129","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:11:06.514 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:11:06.5149288","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:10:59.441 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:10:59.4417711","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:10:46.211 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:10:46.2119629","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:10:43.467 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:10:43.4673159","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:10:22.249 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:10:22.249987","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:09:08.754 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:09:08.7542012","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:09:07.710 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:09:07.7100552","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:09:07.710 Error [.NET ThreadPool Worker] Digma.Collector.Services.UnhandledTraceProcessing.LogUnhandledTraceProcessingService - Fail to process trace DF29F251B69BA0295A3594D30FD51AA0 with 16 spans","exception":{"message":"One or more errors occurred. (Exception of type 'System.OutOfMemoryException' was thrown.)","type":"System.Exception","stackTrace":"   at Digma.Collector.Services.SpanInsertMessageProducer.Produce(IReadOnlyCollection`1 messages) in /src/ApiGateways/Digma.Collector/Services/ISpanInsertMessageProducer.cs:line 44\n   at Digma.Collector.Services.TraceProcessor.AddOrUpdateRootedSpanMeasurements(SpanGraph previousGraph, SpanGraph updatedGraph, Guid accountId, String environment, TraceScopesContainer traceScopesContainer, SpanErrorNode[] updatedErrors) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 866\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 392\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164","source":"Digma.Collector","innerException":null},"details":"","timestamp":"2024-07-31T04:09:07.7100552","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:08:19.431 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:08:19.4315279","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:53.829 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:07:53.8299438","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:52.631 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateOpenTelemetry.Proto.Trace.V1.Span()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:07:52.6313342","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:47.551 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:07:47.5514173","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:46.153 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:07:46.1533257","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:29.622 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:07:29.6225761","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:24.710 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:07:24.7108716","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:07:01.066 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Enumerable.Iterator`1.System.Collections.IEnumerator.get_Current()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T04:07:01.0669276","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:06:25.836 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:06:25.8363767","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:05:44.244 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:05:44.2442661","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:05:39.448 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:05:39.4480974","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:05:24.928 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:05:24.9288574","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:05:24.130 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:05:24.130341","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:05:00.016 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:05:00.0162045","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:04:31.714 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:04:31.7145077","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:04:25.325 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:04:25.3258054","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:03:54.248 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:03:54.2487178","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:03:29.957 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:03:29.957898","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:03:29.631 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:03:29.631798","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:03:05.315 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T04:03:05.3155737","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:02:42.924 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T04:02:42.9240683","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:01:13.151 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T04:01:13.1513102","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 04:01:13.146 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.WriteJson(JsonWriter writer, AnyValue value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 97\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T04:01:13.1463584","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:59:41.435 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:59:41.4359745","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:59:16.152 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:59:16.152719","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:58:02.409 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:58:02.4096696","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:57:58.141 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)\n   at System.Collections.Generic.Dictionary`2.System.Collections.IDictionary.set_Item(Object key, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:57:58.1412932","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:57:16.016 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 1126738, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.GetReadAsyncResult()\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T03:57:16.0164671","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:56:22.125 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:56:22.1258225","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:55:35.213 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:55:35.2130845","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:55:13.415 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:55:13.4159153","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:55:07.528 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:55:07.5280828","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:54:52.827 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T03:54:52.8274952","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:54:52.827 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:54:52.8274952","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:54:38.343 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:54:38.3430702","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:54:33.214 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:54:33.2149971","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:54:00.022 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:54:00.0220984","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:53:38.438 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:53:38.4388736","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:53:36.642 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:53:36.6429894","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:52:38.164 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.WriteJson(JsonWriter writer, AnyValue value, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 97\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T03:52:38.16491","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:52:12.325 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T03:52:12.3256641","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:52:07.443 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:52:07.4431691","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:51:13.733 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:51:13.733367","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:51:11.148 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:51:11.1489974","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:50:55.558 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:50:55.5584089","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:50:31.124 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:50:31.1249546","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:50:07.331 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:50:07.3319754","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:50:05.611 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T03:50:05.6116276","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:49:38.944 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:49:38.9443041","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:49:24.113 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","exception":{"message":"Error getting value from 'Type' on 'Digma.Common.otlp.AnyValueConverter+Item'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method116(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T03:49:24.1137176","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:49:20.327 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:49:20.327312","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:49:18.833 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 0 to type 'System.UInt32'. Path 'VersionedSpanContainers.1619[0].Spans[1].DroppedEventsCount', line 1, position 12373423.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-31T03:49:18.8335097","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:47:57.926 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:47:57.9263741","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:47:51.831 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:47:51.8313585","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:47:38.232 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:47:38.2325245","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:47:36.418 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:47:36.4182325","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:47:20.461 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:47:20.4617372","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:46:55.962 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:46:55.9622702","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:46:39.863 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:46:39.8633249","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:45:47.332 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:45:47.3322002","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:45:15.852 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:45:15.8528004","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:44:29.740 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:44:29.7407988","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:44:07.949 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:44:07.9491892","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:44:06.132 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T03:44:06.132524","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:43:28.716 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T03:43:28.7164977","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:42:29.930 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:42:29.9302916","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:41:54.961 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:41:54.9611234","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:41:41.718 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:41:41.7181299","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:41:40.737 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:41:40.7373348","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:40:15.959 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:40:15.9594459","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:39:51.539 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:39:51.5393788","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:39:49.555 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at OpenTelemetry.Proto.Trace.V1.Span..ctor() in /src/Core/Digma.Common/obj/Release/net6.0/opentelemetry/proto/trace/v1/Trace.cs:line 863\n   at CreateOpenTelemetry.Proto.Trace.V1.Span()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T03:39:49.5553143","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:39:26.718 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:39:26.7185089","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:39:13.247 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:39:13.2474172","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:39:11.439 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:39:11.4398696","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:38:50.255 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:38:50.2552976","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:38:35.121 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:38:35.1212302","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:36:08.338 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:36:08.3389742","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:35:44.535 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:35:44.5359316","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:34:52.311 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:34:52.3117025","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:34:50.614 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:34:50.6146182","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:34:14.630 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:34:14.6308311","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:34:14.426 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:34:14.4262548","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:33:32.833 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:33:32.8339556","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:31:50.825 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:31:50.8256672","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:31:49.030 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:31:49.0306705","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:31:43.849 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T03:31:43.8496019","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:31:20.809 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:31:20.8099276","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:30:52.027 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:30:52.0276962","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:29:49.635 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:29:49.6358556","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:29:49.027 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:29:49.0271121","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:29:46.929 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:29:46.9290949","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:28:50.226 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:28:50.2263379","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:28:43.262 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:28:43.262948","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:28:27.666 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:28:27.6661202","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:28:22.056 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:28:22.0561676","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:27:59.738 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:27:59.7381966","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:27:41.533 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:27:41.5337565","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:25:53.034 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:25:53.0344722","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:25:29.842 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:25:29.8426809","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:25:16.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:25:16.6193163","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:25:14.322 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:25:14.3221147","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:24:59.647 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:24:59.6475472","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:24:55.510 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:24:55.5101252","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:24:20.963 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:24:20.9634227","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:24:17.263 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:24:17.2633587","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:23:26.118 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:23:26.118747","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:23:19.112 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:23:19.1120509","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:23:05.023 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:23:05.0236021","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:23:03.329 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:23:03.329784","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:22:18.725 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:22:18.7255033","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:22:13.826 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:22:13.8265184","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:21:38.168 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:21:38.1681816","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:21:33.513 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T03:21:33.5139381","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:21:18.310 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:21:18.3108038","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:20:39.232 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:20:39.2326285","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:19:45.948 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:19:45.948557","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:19:38.211 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:19:38.2110334","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:56.740 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:56.7409985","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:34.317 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:34.3177266","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:25.309 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Collection was modified; enumeration operation may not execute.","exception":{"message":"Collection was modified; enumeration operation may not execute.","type":"System.InvalidOperationException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:25.3099552","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:13.353 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:13.3532981","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:09.950 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:09.950425","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:16:08.935 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:16:08.9351994","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:15:55.327 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:15:55.3273397","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:15:52.223 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:15:52.2230565","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:15:08.864 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T03:15:08.864343","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:14:21.624 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:14:21.6249168","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:14:15.318 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:14:15.3181092","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:14:02.511 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:14:02.51146","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:48.013 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:13:48.0130827","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:34.440 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:13:34.4408248","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:33.322 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:13:33.3229836","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:19.240 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:13:19.240491","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:18.310 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:13:18.3100116","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:13:02.818 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:13:02.8186098","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:12:46.536 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:12:46.5364001","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:12:25.757 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:12:25.7574986","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:12:04.454 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:12:04.454309","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:43.720 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:43.7205884","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:41.123 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:41.1230495","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:27.243 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:27.2431936","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:21.018 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:21.0187032","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:06.528 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:06.5283587","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:11:00.963 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:11:00.9632497","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:10:36.858 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:10:36.8587935","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:09:22.458 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:09:22.4584843","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:08:36.643 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:08:36.6438567","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:08:00.962 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:08:00.9623251","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:07:20.427 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:07:20.4278414","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:07:17.866 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:07:17.8665021","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:07:04.139 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:07:04.1399926","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:48.810 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:48.8100203","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:34.858 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:34.8581735","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:32.560 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:32.5609245","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:18.748 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:18.7480169","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:17.714 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:17.714662","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:04.319 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:04.3199666","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:06:02.264 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:06:02.2646576","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:03:59.212 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:03:59.2121364","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:03:58.835 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T03:03:58.8351154","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:03:58.343 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:03:58.34318","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:01:55.140 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:01:55.1403809","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:01:54.022 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:01:54.0223991","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:01:25.522 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:01:25.5220534","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:01:06.424 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T03:01:06.4246241","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:01:05.230 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T03:01:05.2304735","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 03:00:44.228 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: GET, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 1s ago, unanswered-write: 1s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 4157159, in-pipe: 0, out-pipe: 0, last-heartbeat: 1s ago, last-mbeat: 1s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.GetReadAsyncResult()\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-31T03:00:44.2286755","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:59:40.244 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:59:40.2441443","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:59:12.512 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:59:12.5128274","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:58:54.458 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T02:58:54.4588335","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:58:01.939 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:58:01.939404","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:57:59.141 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:57:59.1416564","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:57:45.826 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:57:45.8264826","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:57:43.423 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:57:43.4237025","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:57:28.019 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T02:57:28.0193588","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:56:58.658 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:56:58.6582869","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:56:52.762 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:56:52.7629575","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:53:34.013 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:53:34.0131002","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:52:39.125 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:52:39.1256429","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:52:23.220 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:52:23.2201746","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:51:53.834 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:51:53.8340678","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:50:55.064 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:50:55.0645669","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:50:53.050 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:50:53.0502022","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:49:57.459 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T02:49:57.4591834","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:49:21.821 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:49:21.8215505","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:49:17.137 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:49:17.137444","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:48:27.825 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:48:27.8254258","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:48:27.445 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:48:27.4451675","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:48:13.914 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:48:13.9144062","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:47:53.564 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T02:47:53.5640221","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:47:53.564 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WriteEnd(JsonToken token)\n   at Newtonsoft.Json.JsonWriter.AutoCompleteClose(JsonContainerType type)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:47:53.5640221","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:47:51.763 Error [.NET ThreadPool Worker] Digma.Collector.Services.UnhandledTraceProcessing.LogUnhandledTraceProcessingService - Fail to process trace 7EC516E7E571A20A4BE5BD9AAEAE43CB with 16 spans","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.Jaeger.OtlpRequestConverterForJaegerForJaeger.ConvertToSpan(SpanInfo spanInfo) in /src/Core/Digma.Common/Jaeger/OtlpRequestConverterForJaeger.cs:line 61\n   at System.Linq.Enumerable.SelectIListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.Jaeger.OtlpRequestConverterForJaegerForJaeger.ConvertToScopeSpans(IEnumerable`1 spans)+MoveNext() in /src/Core/Digma.Common/Jaeger/OtlpRequestConverterForJaeger.cs:line 54\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.Jaeger.OtlpRequestConverterForJaegerForJaeger.Convert(IEnumerable`1 spans) in /src/Core/Digma.Common/Jaeger/OtlpRequestConverterForJaeger.cs:line 30\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 404\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T02:47:51.7638888","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:47:33.152 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:47:33.1528826","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:47:04.625 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:47:04.6255148","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:46:07.343 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:46:07.3434736","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:46:06.019 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:46:06.0195543","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:45:49.324 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:45:49.3248604","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:45:29.661 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:45:29.6616914","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:44:56.528 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T02:44:56.5284138","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:44:05.565 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:44:05.5650306","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:42:37.349 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:42:37.3495691","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:42:11.230 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:42:11.2304606","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:41:47.409 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:41:47.4094337","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:41:33.434 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:41:33.4348861","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:41:32.725 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:41:32.7257441","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:41:01.820 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:41:01.8207275","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:41:00.824 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:41:00.8241192","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:40:46.736 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:40:46.7360311","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:40:45.620 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T02:40:45.6203614","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:40:31.562 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:40:31.5624678","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:40:30.668 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:40:30.6682471","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:40:26.225 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:40:26.2250959","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:36:42.531 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:36:42.5313653","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:36:26.339 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:36:26.3394254","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:36:03.950 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T02:36:03.9507198","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:35:02.465 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:35:02.4654559","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:35:02.028 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T02:35:02.0280837","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:34:59.646 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.604[0].Spans[3].Attributes[2].Value.Type', line 1, position 4576413.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T02:34:59.6468328","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:34:43.710 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:34:43.710198","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:34:11.142 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:34:11.1420153","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:34:08.918 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:34:08.91857","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:33:53.529 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:33:53.5297642","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:33:52.930 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:33:52.9305179","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:33:15.630 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:33:15.6304458","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:32:58.123 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:32:58.1231991","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:32:44.422 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:32:44.4228938","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:32:26.409 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:32:26.4099905","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:32:02.420 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:32:02.4200616","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:31:18.450 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:31:18.4501567","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:28:48.056 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:28:48.0562387","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:27:31.140 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:27:31.14084","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:25:49.351 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:25:49.3511295","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:25:15.009 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:25:15.0098899","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:22:58.037 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:22:58.0379052","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:22:30.144 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:22:30.1440219","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:21:19.417 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:21:19.4179188","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:20:54.159 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:20:54.1594455","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:20:17.245 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:20:17.2459294","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:20:13.646 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-31T02:20:13.6462486","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:19:48.422 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:19:48.422843","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:18:56.841 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:18:56.8413188","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:18:52.258 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:18:52.2581237","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:18:37.217 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:18:37.2173168","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:18:10.341 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:18:10.3418601","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:17:58.635 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:17:58.6352103","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:17:30.564 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:17:30.5641587","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:16:11.643 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:16:11.6432737","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:15:48.034 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:15:48.0347605","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:15:19.726 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:15:19.7264543","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:14:42.136 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:14:42.1362382","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:13:21.033 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:13:21.0332965","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:13:06.415 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:13:06.4151019","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:12:12.661 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:12:12.661479","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:12:11.653 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:12:11.6536577","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:10:57.052 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:10:57.0523423","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:10:34.328 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:10:34.3286503","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:10:19.410 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T02:10:19.4102564","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:08:03.964 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:08:03.9646089","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:07:41.418 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:07:41.4181273","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:07:31.965 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:07:31.965178","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:07:06.910 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:07:06.9100756","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:06:01.453 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:06:01.4532452","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:05:59.710 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:05:59.7105916","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:05:11.965 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:05:11.9651732","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:04:39.341 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:04:39.341978","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:01:50.310 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:01:50.310691","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:01:35.133 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:01:35.1333277","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:01:35.133 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:01:35.1333277","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:01:35.131 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.SpanContainer()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T02:01:35.1317244","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:00:51.066 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:00:51.0660039","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 02:00:19.233 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T02:00:19.2339106","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:58:44.535 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:58:44.5354103","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:53:32.614 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:53:32.6140067","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:53:03.915 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:53:03.9153172","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:50:47.137 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:50:47.1375303","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:50:27.264 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:50:27.2642033","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:48:51.936 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:48:51.9361194","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:48:29.746 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:48:29.7465393","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:46:23.562 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:46:23.5621511","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:45:46.628 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:45:46.6285665","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:42:52.622 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:42:52.6222052","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:42:34.422 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:42:34.4224125","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:41:58.017 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:41:58.0175516","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:41:31.809 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:41:31.8096838","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:41:23.524 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:41:23.524758","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:40:54.016 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:40:54.016828","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:40:16.541 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T01:40:16.5415359","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:40:01.639 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:40:01.6393008","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:39:44.224 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:39:44.2241369","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:39:08.017 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:39:08.0176896","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:38:50.250 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:38:50.2501071","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:38:50.248 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T01:38:50.2485082","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:38:50.248 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:38:50.2485082","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:37:39.818 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T01:37:39.8186731","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:37:10.166 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:37:10.1662457","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:36:48.151 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:36:48.1513005","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:36:33.957 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:36:33.9572871","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:36:07.651 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:36:07.65195","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:35:33.366 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:35:33.3667824","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/31 01:29:22.809 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:29:22.8096886","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:29:08.910 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:29:08.9108094","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:29:07.433 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error TryConnect","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at Pipelines.Sockets.Unofficial.Arenas.ArrayPoolAllocator`1.Allocate(Int32 length) in /_/src/Pipelines.Sockets.Unofficial/Arenas/Allocator.cs:line 51\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1.AllocateAndAttachBlock(Block`1 previous) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 190\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator, Int32 blockSizeBytes) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 184\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 156\n   at StackExchange.Redis.PhysicalConnection..ctor(PhysicalBridge bridge) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1817\n   at StackExchange.Redis.PhysicalBridge.TryConnect(ILogger log) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 1398\n   at StackExchange.Redis.PhysicalBridge.OnHeartbeat(Boolean ifConnectedOnly) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 651","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:29:07.4336745","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:29:06.738 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:29:06.7385571","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:29:06.420 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error TryConnect","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at Pipelines.Sockets.Unofficial.Arenas.ArrayPoolAllocator`1.Allocate(Int32 length) in /_/src/Pipelines.Sockets.Unofficial/Arenas/Allocator.cs:line 51\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1.AllocateAndAttachBlock(Block`1 previous) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 190\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator, Int32 blockSizeBytes) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 184\n   at Pipelines.Sockets.Unofficial.Arenas.Arena`1..ctor(ArenaOptions options, Allocator`1 allocator) in /_/src/Pipelines.Sockets.Unofficial/Arenas/ArenaT.cs:line 156\n   at StackExchange.Redis.PhysicalConnection..ctor(PhysicalBridge bridge) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1817\n   at StackExchange.Redis.PhysicalBridge.TryConnect(ILogger log) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 1398\n   at StackExchange.Redis.PhysicalBridge.OnDisconnected(ConnectionFailureType failureType, PhysicalConnection connection, Boolean& isCurrent, State& oldState) in /_/src/StackExchange.Redis/PhysicalBridge.cs:line 488\n   at StackExchange.Redis.PhysicalConnection.RecordConnectionFailed(ConnectionFailureType failureType, Exception innerException, String origin, Boolean isInitialConnect, IDuplexPipe connectingPipe) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 398\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1812","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:29:06.4200866","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:58.050 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:58.0506313","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:33.750 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:33.7505726","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:31.925 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:31.925948","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:18.458 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:18.4582743","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:16.122 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:16.1226535","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:01.824 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:01.8247823","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:27:00.962 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:27:00.9625761","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:26:46.043 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:26:46.0436328","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:26:45.659 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:26:45.6598312","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:26:06.625 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:26:06.625971","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:26:05.658 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:26:05.6587335","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:23:55.721 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:23:55.7214586","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:23:36.060 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:23:36.0606373","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:22:47.050 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:22:47.0503844","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:22:43.019 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:22:43.0192536","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:21:54.027 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:21:54.0277929","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:21:13.167 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:21:13.1676535","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:19:57.210 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:19:57.2109605","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:19:31.760 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:19:31.7606821","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:19:15.712 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-31T01:19:15.7120078","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:18:40.927 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:18:40.9272689","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:18:23.629 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:18:23.6298164","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:17:59.517 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:17:59.5170488","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:16:22.238 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:16:22.2389477","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:16:02.832 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:16:02.8327616","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:14:54.529 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:14:54.5293143","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:13:09.943 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:13:09.9433018","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:10:35.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:10:35.6198621","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:10:12.250 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:10:12.250761","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:08:49.028 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:08:49.0280478","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:08:35.430 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:08:35.4301346","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:05:53.944 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:05:53.944212","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:05:00.429 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:05:00.4292876","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:03:49.837 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:03:49.8374194","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:03:32.560 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:03:32.5603593","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:03:17.326 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:03:17.3268049","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:02:11.153 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:02:11.1537795","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:01:25.850 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:01:25.8504511","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:00:38.638 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:00:38.6383525","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 01:00:23.441 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T01:00:23.4410333","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:59:34.812 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:59:34.8126944","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:59:19.115 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:59:19.115054","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:58:40.143 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:58:40.1433385","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:58:19.240 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:58:19.2406384","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:56:46.148 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:56:46.1484979","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:56:26.113 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:56:26.1133896","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:53:52.464 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T00:53:52.4646111","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:53:38.448 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:53:38.4489199","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:52:47.134 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:52:47.1343034","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:52:33.156 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:52:33.1565726","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:52:06.365 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:52:06.3655991","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:51:02.609 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:51:02.6095566","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:50:27.739 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:50:27.7399265","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:50:17.218 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:50:17.2184024","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:50:01.432 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:50:01.4326514","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:45:52.649 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:45:52.6498344","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:45:52.649 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:45:52.6498344","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:44:45.527 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:44:45.5278389","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:44:31.823 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:44:31.8233393","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:44:10.156 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:44:10.1569262","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:40:10.340 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:40:10.3401666","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:39:43.417 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:39:43.4175366","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:39:24.223 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:39:24.2230242","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:38:37.725 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:38:37.7255576","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:37:41.824 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T00:37:41.8241009","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:36:22.741 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:36:22.7414254","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:36:22.338 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:36:22.3385146","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:35:02.025 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:35:02.0256274","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:34:44.928 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:34:44.9282107","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:34:32.123 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:34:32.1233995","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:34:12.359 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:34:12.359327","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:34:11.426 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-31T00:34:11.4263199","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:32:11.240 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:32:11.2400921","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:54.514 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:31:54.5143509","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:54.510 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.556[0].Spans[2].Attributes[8].Value.Type', line 1, position 4205960.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-31T00:31:54.5100239","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:54.510 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'StartTimeUnixNano' on 'OpenTelemetry.Proto.Trace.V1.Span'.","exception":{"message":"Error getting value from 'StartTimeUnixNano' on 'OpenTelemetry.Proto.Trace.V1.Span'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method82(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-31T00:31:54.5100239","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:54.466 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:31:54.4660264","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:38.566 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:31:38.5664176","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:31:37.014 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-31T00:31:37.0149184","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:30:59.961 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:30:59.9611732","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:30:08.245 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:30:08.2454618","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:29:49.134 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:29:49.1345795","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:29:20.733 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:29:20.7333682","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:29:01.029 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:29:01.0295882","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:24:24.733 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:24:24.7331964","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:23:42.233 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:23:42.2338265","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:20:25.620 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:20:25.6205364","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:19:35.058 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:19:35.0588779","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:18:41.660 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:18:41.660778","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:18:29.256 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:18:29.2561138","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:18:14.061 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:18:14.0619884","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:12:43.629 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:12:43.6291634","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:12:24.324 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:12:24.3240633","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:12:00.233 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:12:00.2333902","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:11:35.520 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:11:35.5205673","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:08:35.210 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:08:35.2100359","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:08:09.135 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:08:09.1351216","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/31 00:04:07.954 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-31T00:04:07.9547385","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:55.915 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:58:55.9151089","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:54.359 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:58:54.359444","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:39.259 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:58:39.2593241","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:38.738 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T23:58:38.7384339","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:38.429 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.HashSet`1.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.HashSet`1.AddIfNotPresent(T value, Int32& location)\n   at System.Collections.Generic.HashSet`1.UnionWith(IEnumerable`1 other)\n   at System.Collections.Generic.HashSet`1..ctor(IEnumerable`1 collection, IEqualityComparer`1 comparer)\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:58:38.4296217","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:58:19.810 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:58:19.810061","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:57:35.018 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:57:35.0182204","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:57:09.109 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:57:09.1093818","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:56:57.467 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:56:57.4677651","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:56:39.710 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:56:39.7100705","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:52:15.055 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:52:15.0555409","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:52:13.936 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:52:13.9367147","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:51:17.959 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:51:17.9593127","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:46:03.061 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:46:03.0616936","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:45:43.230 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:45:43.2305021","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:44:08.613 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:44:08.6130756","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:43:43.819 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:43:43.819809","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:42:25.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:42:25.6193035","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:36:56.434 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:36:56.4345259","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:36:55.115 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:36:55.1156947","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:32:39.330 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:32:39.3306453","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:32:22.246 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:32:22.2460011","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:27:46.411 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:27:46.4113538","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:27:23.026 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:27:23.0260975","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:24:00.016 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:24:00.0165084","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:18:44.164 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:18:44.1644422","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:13:37.046 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:13:37.0460714","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:08:29.756 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:08:29.7565594","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:03:26.017 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:03:26.0173125","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:03:07.109 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:03:07.1094255","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 23:01:13.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T23:01:13.6192519","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:55:58.319 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:55:58.3191869","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:55:16.566 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:55:16.5669139","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:53:09.456 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:53:09.4561771","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:47:43.766 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:47:43.7666921","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:42:28.166 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:42:28.1665712","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:42:04.148 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketClosed","exception":{"message":"SocketClosed (WriteException, last-recv: 0) on digma-redis:6379/Interactive, Idle/MarkProcessed, last: SETEX, origin: ReadFromPipe, outstanding: 1, last-read: 0s ago, last-write: 0s ago, unanswered-write: 0s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 1 of 2 available, in: 0, in-pipe: 0, out-pipe: 0, last-heartbeat: 0s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.<ExecuteAsyncImpl>g__ExecuteAsyncImpl_Awaited|158_0[T](ConnectionMultiplexer this, ValueTask`1 write, TaskCompletionSource`1 tcs, Message message, ServerEndPoint server) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2174\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:42:04.1487066","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:37:27.511 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:37:27.5118276","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:32:25.513 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:32:25.5133483","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:26:58.725 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:26:58.7258269","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:21:06.852 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:21:06.8520704","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:15:59.667 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:15:59.6671847","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:10:50.109 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:10:50.109571","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:05:42.031 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:05:42.0313573","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 22:00:32.741 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T22:00:32.741596","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:55:13.715 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:55:13.7152719","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:55:08.245 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:55:08.2459781","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:52:27.217 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"After parsing a value an unexpected character was encountered: K. Path 'VersionedSpanContainers.1890[1].Spans[3].Attributes[6].Value.Value', line 48, position 3.","type":"Newtonsoft.Json.JsonReaderException","stackTrace":"   at Newtonsoft.Json.JsonTextReader.ParsePostValue(Boolean ignoreComments)\n   at Newtonsoft.Json.JsonTextReader.Read()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:52:27.2174708","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:50:08.641 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:50:08.6418867","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:49:49.752 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:49:49.7525002","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:49:36.048 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:49:36.0486909","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:49:17.565 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:49:17.565459","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:47:24.853 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:47:24.8533449","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:47:21.635 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"After parsing a value an unexpected character was encountered: K. Path 'VersionedSpanContainers.1890[1].Spans[3].Attributes[6].Value.Value', line 48, position 3.","type":"Newtonsoft.Json.JsonReaderException","stackTrace":"   at Newtonsoft.Json.JsonTextReader.ParsePostValue(Boolean ignoreComments)\n   at Newtonsoft.Json.JsonTextReader.Read()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:47:21.6351444","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:47:20.218 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:47:20.2183903","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:47:19.613 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:47:19.6132326","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:47:05.538 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis error: ERR Protocol error: too big inline request","exception":null,"details":"","timestamp":"2024-07-30T21:47:05.5381411","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:45.834 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:45.8347615","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:39.615 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:39.6153561","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:24.915 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:24.9154214","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:16.244 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:16.2443489","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:13.013 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:13.0139489","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:46:00.637 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:46:00.6376133","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:45:58.212 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:45:58.2121835","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:45:54.421 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:45:54.4212979","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:45:19.826 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:45:19.8261421","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:45:03.019 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Timeout awaiting response (outbound=17032KiB, inbound=0KiB, 5188ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:1BD62C9EEB802E5C5FBA91209E173C3D:Data, inst: 0, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 0, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 0, async-ops: 2868, serverEndpoint: digma-redis:6379, conn-sec: 18537.88, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b7w24(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=0,CompletedItems=1666893,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","exception":{"message":"Timeout awaiting response (outbound=17032KiB, inbound=0KiB, 5188ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:1BD62C9EEB802E5C5FBA91209E173C3D:Data, inst: 0, qu: 0, qs: 2, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 0, in-pipe: 0, out-pipe: 0, last-in: 0, cur-in: 0, sync-ops: 0, async-ops: 2868, serverEndpoint: digma-redis:6379, conn-sec: 18537.88, aoc: 1, mc: 1/1/0, mgr: 2 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b7w24(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=15,QueuedItems=0,CompletedItems=1666893,Timers=30), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at StackExchange.Redis.ConnectionMultiplexer.<ExecuteAsyncImpl>g__ExecuteAsyncImpl_Awaited|158_0[T](ConnectionMultiplexer this, ValueTask`1 write, TaskCompletionSource`1 tcs, Message message, ServerEndPoint server) in /_/src/StackExchange.Redis/ConnectionMultiplexer.cs:line 2174\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:45:03.0199111","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:44:58.539 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis internal error WriteTo","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.DefaultPipeWriter.GetSpan(Int32 sizeHint)\n   at StackExchange.Redis.PhysicalConnection.WriteRaw(PipeWriter writer, String value, Int32 expectedLength) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1228\n   at StackExchange.Redis.PhysicalConnection.WriteUnifiedPrefixedString(PipeWriter writer, Byte[] prefix, String value) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1153\n   at StackExchange.Redis.PhysicalConnection.WriteBulkString(RedisValue& value, PipeWriter output) in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 820\n   at StackExchange.Redis.Message.CommandKeyValueValueMessage.WriteImpl(PhysicalConnection physical) in /_/src/StackExchange.Redis/Message.cs:line 1107\n   at StackExchange.Redis.Message.WriteTo(PhysicalConnection physical) in /_/src/StackExchange.Redis/Message.cs:line 711","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:44:58.5394521","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:44:53.039 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:44:53.0396016","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:43:48.161 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:43:48.161635","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:43:45.351 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)\n   at System.Collections.Generic.Dictionary`2.System.Collections.IDictionary.set_Item(Object key, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:43:45.3515767","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:43:42.127 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:43:42.1279566","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:43:00.114 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:43:00.1142737","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:44.823 Error [.NET ThreadPool Worker] StackExchange.Redis.Extensions.Core.Implementations.RedisConnectionPoolManager - Redis connection error SocketFailure","exception":{"message":"SocketFailure (ReadException, last-recv: 8192) on digma-redis:6379/Interactive, Idle/Faulted, last: ECHO, origin: ReadFromPipe, outstanding: 1, last-read: 1s ago, last-write: 1s ago, unanswered-write: 1s ago, keep-alive: 60s, state: ConnectedEstablished, mgr: 0 of 2 available, in: 4855276, in-pipe: 0, out-pipe: 0, last-heartbeat: 1s ago, last-mbeat: 0s ago, global: 0s ago, v: 2.7.4.20928","type":"StackExchange.Redis.RedisConnectionException","stackTrace":"   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.IO.IOException","stackTrace":"   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)\n   at System.IO.Pipelines.Pipe.GetReadAsyncResult()\n   at StackExchange.Redis.PhysicalConnection.ReadFromPipe() in /_/src/StackExchange.Redis/PhysicalConnection.cs:line 1760","source":"System.Private.CoreLib","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Buffers.TlsOverPerCoreLockedStacksArrayPool`1.Rent(Int32 minimumLength)\n   at System.IO.Pipelines.Pipe.AllocateSegment(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.AllocateWriteHeadSynchronized(Int32 sizeHint)\n   at System.IO.Pipelines.Pipe.GetMemory(Int32 sizeHint)\n   at Pipelines.Sockets.Unofficial.SocketConnection.DoReceiveAsync() in /_/src/Pipelines.Sockets.Unofficial/SocketConnection.Receive.cs:line 54","source":"System.Private.CoreLib","innerException":null}}},"details":"","timestamp":"2024-07-30T21:42:44.8238422","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:44.415 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:42:44.4151092","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:44.415 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Convert.ToBase64String(ReadOnlySpan`1 bytes, Base64FormattingOptions options)\n   at Google.Protobuf.ByteString.ToBase64()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:42:44.4151092","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:40.728 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:42:40.7281915","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:06.526 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:42:06.5269269","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:06.139 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T21:42:06.1393967","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:42:01.751 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:42:01.751848","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:41:49.459 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:41:49.4596422","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:53.641 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:40:53.6418747","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:52.354 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:40:52.3546949","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:32.934 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:40:32.9347484","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:31.420 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:40:31.4208265","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:13.862 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:40:13.8628096","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:40:02.948 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T21:40:02.9482299","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:39:47.529 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:39:47.5294846","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:39:28.951 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:39:28.9515621","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:39:15.530 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:39:15.5301931","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:59.358 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:59.3586116","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:57.457 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:57.4576146","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:54.248 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:54.2489634","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:24.859 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:24.8599591","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:13.756 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:13.7563291","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:13.310 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:38:13.3100068","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:38:09.311 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-30T21:38:09.3116589","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:37:27.126 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:37:27.1268968","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:37:08.448 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:37:08.4487322","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:37:05.353 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:37:05.3535235","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:37:04.036 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:37:04.0366339","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:37:02.637 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:37:02.6377583","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:36:34.610 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:36:34.6100164","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:36:17.330 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:36:17.3306693","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:36:04.134 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:36:04.134029","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:35:46.619 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:35:46.6195825","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:35:45.210 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:35:45.2101479","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:35:31.652 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:35:31.6524257","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:35:30.338 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:35:30.3380105","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:35:16.857 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:35:16.8570017","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:34:57.668 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:34:57.6681467","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:34:35.936 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:34:35.9367615","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:34:34.654 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:34:34.6541057","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:33:59.016 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:33:59.0164734","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:33:39.458 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:33:39.4582005","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:33:28.852 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:33:28.8521782","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:33:27.957 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:33:27.9579521","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:32:29.541 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:32:29.5412807","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:32:27.145 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:32:27.1453636","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:31:54.952 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:31:54.9523001","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:31:33.955 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:31:33.9550076","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:31:19.564 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:31:19.5647357","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:31:17.737 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:31:17.7373835","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:54.510 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Collection was modified; enumeration operation may not execute.","exception":{"message":"Collection was modified; enumeration operation may not execute.","type":"System.InvalidOperationException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\n   at System.Linq.Enumerable.SelectManySingleSelectorIterator`2.MoveNext()\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:30:54.5100982","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:39.569 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T21:30:39.5696551","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:27.729 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:30:27.7291544","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:26.343 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:30:26.3431534","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:23.827 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.917[1].Spans[5].Attributes[3].Value.Type', line 1, position 8765764.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-30T21:30:23.8278611","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:09.444 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:30:09.444274","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:30:04.034 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:30:04.0340388","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:29:22.852 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:29:22.8523967","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:29:18.625 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:29:18.6257007","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:29:00.559 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:29:00.5598324","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:28:55.313 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:28:55.3133793","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:28:33.458 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:28:33.4589232","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:27:50.362 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:27:50.3627188","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:27:45.326 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:27:45.3269353","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:27:34.009 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:27:34.0096504","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:27:33.661 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:27:33.6611558","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:27:09.740 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:27:09.7409466","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:26:09.213 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:26:09.2134546","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:26:06.557 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:26:06.5579604","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:25:53.756 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:25:53.7566133","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:25:51.428 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:25:51.428295","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:24:54.924 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T21:24:54.9240165","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:24:31.360 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:24:31.3604815","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:24:10.450 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:24:10.450746","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:23:24.134 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:23:24.1348917","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:22:57.666 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:22:57.6662216","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:22:16.324 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:22:16.3243365","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:22:16.031 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:22:16.0315968","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:22:14.854 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:22:14.8542847","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:22:10.769 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.1212[1].Spans[0].Attributes[7].Value.Type', line 1, position 11315585.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Enum.InternalBoxEnum(RuntimeType enumType, Int64 value)\n   at System.Enum.ToObject(Type enumType, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-30T21:22:10.7690051","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:21:50.940 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:21:50.940196","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:20:20.145 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:20:20.145882","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:59.654 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:19:59.6548906","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:57.815 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Utilities.BoxedPrimitives.Get(Int64 value)\n   at Newtonsoft.Json.JsonTextReader.ParseReadNumber(ReadType readType, Char firstChar, Int32 initialPosition)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:19:57.815453","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:43.068 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Common.otlp.VersionedSpanContainer.GetOrphans()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.TryMakeTraceCompleted(VersionedSpanContainer trace) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 49\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T21:19:43.0681896","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:28.120 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:19:28.1205222","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:23.810 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Error getting value from 'EndTimeUnixNano' on 'OpenTelemetry.Proto.Trace.V1.Span'.","exception":{"message":"Error getting value from 'EndTimeUnixNano' on 'OpenTelemetry.Proto.Trace.V1.Span'.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at lambda_method83(Closure , Object )\n   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)","source":"Anonymously Hosted DynamicMethods Assembly","innerException":null}},"details":"","timestamp":"2024-07-30T21:19:23.8101187","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:19:08.222 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonWriter.AutoComplete(JsonToken tokenBeingWritten)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:19:08.2228629","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:18:48.112 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.Collections.RepeatedField`1.SetSize(Int32 size)\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-30T21:18:48.112841","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:18:28.424 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T21:18:28.4246429","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:18:13.364 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:18:13.3648367","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:18:09.647 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:18:09.6471769","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:18:08.537 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.ByteString.FromBase64(String bytes)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-30T21:18:08.5377467","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:17:51.947 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:17:51.9473188","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:17:50.352 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:17:50.3522232","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:17:31.558 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:17:31.5581832","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:16:55.017 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:16:55.0176457","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:16:54.709 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:16:54.7093905","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:16:37.954 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:16:37.9540597","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:16:34.626 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:16:34.626615","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:16:01.153 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:16:01.1533825","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:15:26.236 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:15:26.2360127","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:15:23.440 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:15:23.4403578","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:15:04.760 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:15:04.760749","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:14:18.965 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:14:18.9659589","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:14:17.732 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Resize(Int32 newSize, Boolean forceNewHashCodes)\n   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)\n   at System.Collections.Generic.Dictionary`2.System.Collections.IDictionary.set_Item(Object key, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:14:17.7324093","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:14:15.911 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Digma.Common.otlp.RepeatedKeyValueConverter.<>c.<ReadJson>b__1_0(KeyValuePair`2 x) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 191\n   at System.Linq.Enumerable.SelectListIterator`2.MoveNext()\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-30T21:14:15.911754","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:13:59.964 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:13:59.9641182","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:13:57.535 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:13:57.5350595","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:13:54.124 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T21:13:54.1248705","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:13:19.228 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:13:19.2280371","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:13:00.131 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:13:00.1310204","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:12:28.324 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:12:28.3243062","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:12:09.633 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:12:09.6331573","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:11:17.554 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:11:17.554065","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:11:15.113 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:11:15.113727","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:10:42.047 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:10:42.0470966","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:10:38.062 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:10:38.0620963","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:10:24.414 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:10:24.4148157","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:10:22.968 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:10:22.9688333","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:49.636 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:49.6360999","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:47.114 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:47.1149252","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:32.925 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:32.9255604","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:21.358 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:21.3589394","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:19.918 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:19.9183011","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:16.766 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:16.7667558","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:09:02.646 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.Append(Char[] value, Int32 startIndex, Int32 charCount)\n   at System.IO.StringWriter.Write(Char[] buffer, Int32 index, Int32 count)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:09:02.6468236","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:08:29.242 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:08:29.2421317","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:07:45.157 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:07:45.157046","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:07:26.146 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:07:26.1468719","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:06:08.132 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:06:08.1323898","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:06:04.447 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:06:04.4471394","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:05:40.145 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:05:40.1450905","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:05:21.356 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:05:21.3565317","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:04:47.810 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:04:47.8109437","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:04:27.164 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:04:27.1645209","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:04:04.865 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:04:04.8651717","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:03:48.862 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T21:03:48.8628948","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:03:28.161 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:03:28.1610262","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:03:27.240 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadStringValue(ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ReadAsString()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:03:27.2409222","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:03:09.038 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 3 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.3024[0].Spans[0].Attributes[5].Value.Type', line 1, position 25274425.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Enum.InternalBoxEnum(RuntimeType enumType, Int64 value)\n   at System.Enum.ToObject(Type enumType, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"System.Private.CoreLib","innerException":null}},"details":"","timestamp":"2024-07-30T21:03:09.0382525","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:02:49.913 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:02:49.9135288","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:02:45.914 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.JsonTextWriter.WriteEnd(JsonToken token)\n   at Newtonsoft.Json.JsonWriter.AutoCompleteClose(JsonContainerType type)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:02:45.9145507","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:02:28.632 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:02:28.6327974","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:01:45.736 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:01:45.7364388","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:01:44.718 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:01:44.7188547","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 21:00:47.509 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T21:00:47.5097442","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:59:57.354 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T20:59:57.3543351","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:58:06.509 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T20:58:06.5095806","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:57:39.042 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:57:39.0420116","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:57:15.610 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:57:15.6100401","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:56:55.850 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:56:55.8509187","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:56:06.437 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:56:06.4377443","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:56:05.118 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Enumerable.Select[TSource,TResult](IEnumerable`1 source, Func`2 selector)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:56:05.1181782","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:55:50.828 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:55:50.8287974","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:55:28.638 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:55:28.6386825","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:54:57.160 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:54:57.160558","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:54:56.857 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:54:56.8575298","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:54:36.113 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:54:36.1135405","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:54:17.449 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WriteValue(String value)\n   at Newtonsoft.Json.JsonWriter.WriteValue(JsonWriter writer, PrimitiveTypeCode typeCode, Object value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:54:17.449275","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:53:43.514 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:53:43.5148497","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:53:41.547 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:53:41.5471462","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:52:30.161 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.Collections.RepeatedField`1.System.Collections.IEnumerable.GetEnumerator()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-30T20:52:30.1615089","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:51:24.757 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:51:24.7574415","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:51:20.137 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:51:20.1378745","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:50:33.258 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:50:33.2585739","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:50:32.654 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:50:32.654403","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:50:30.712 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:50:30.7128554","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:50:16.058 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:50:16.0584566","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:50:15.246 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:50:15.2463383","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:49:12.364 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:49:12.3649296","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:49:01.711 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:49:01.7119742","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:48:22.726 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:48:22.7267987","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:48:10.467 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:48:10.4676301","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:47:46.027 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:47:46.0278906","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:46:30.826 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:46:30.8268563","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:45:47.237 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:45:47.2374952","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:45:02.344 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T20:45:02.3441474","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:43:05.424 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:43:05.4240677","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:43:04.826 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char[] value, Int32 startIndex, Int32 length)\n   at Newtonsoft.Json.JsonTextReader.ParseReadString(Char quote, ReadType readType)\n   at Newtonsoft.Json.JsonTextReader.ParseValue()\n   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:43:04.8268755","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:43:01.227 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:43:01.2271077","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:42:59.934 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Google.Protobuf.Collections.RepeatedField`1.SetSize(Int32 size)\n   at Google.Protobuf.Collections.RepeatedField`1.AddRange(IEnumerable`1 values)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Google.Protobuf","innerException":null},"details":"","timestamp":"2024-07-30T20:42:59.9343296","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:42:40.154 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:42:40.1546768","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:42:38.639 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:42:38.6395812","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:40:57.712 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:40:57.7125151","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:39:48.938 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:39:48.9387535","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:39:10.459 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:39:10.4591432","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:38:55.163 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:38:55.1639122","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:38:39.548 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:38:39.5485037","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:38:36.137 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name, Boolean escape)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:38:36.137572","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:36:33.453 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:36:33.4535303","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:35:33.412 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:35:33.4128574","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:34:32.519 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:34:32.5198151","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:33:04.020 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:33:04.020977","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:32:35.735 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:32:35.7357409","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:32:20.029 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:32:20.0291422","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:32:18.345 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at CreateDigma.Common.otlp.AnyValueConverter+Item()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-30T20:32:18.3459448","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:32:02.711 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:32:02.7113889","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:31:24.232 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:31:24.2328231","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:30:56.724 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:30:56.7242222","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:30:54.131 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:30:54.1317893","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:28:47.649 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:28:47.6494066","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:27:52.713 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:27:52.7133887","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:27:04.013 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at OpenTelemetry.Proto.Trace.V1.Span..ctor() in /src/Core/Digma.Common/obj/Release/net6.0/opentelemetry/proto/trace/v1/Trace.cs:line 863\n   at CreateOpenTelemetry.Proto.Trace.V1.Span()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateNewObject(JsonReader reader, JsonObjectContract objectContract, JsonProperty containerMember, JsonProperty containerProperty, String id, Boolean& createdFromNonDefaultCreator)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId)\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken)\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next)\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Digma.Common","innerException":null},"details":"","timestamp":"2024-07-30T20:27:04.0135157","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:26:43.141 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T20:26:43.1413977","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:26:31.017 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:26:31.017703","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:26:27.051 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)\n   at System.IO.StringWriter.Write(Char value)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:26:27.0515982","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:26:14.827 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:26:14.827797","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:26:08.830 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:26:08.8300423","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:25:52.418 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:25:52.4188096","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:25:21.254 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:25:21.2542804","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:19:50.335 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:19:50.3354228","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:19:04.936 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:19:04.936188","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:18:18.832 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:18:18.8324923","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:18:05.067 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:18:05.0678778","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:18:03.764 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:18:03.7641094","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:18:02.645 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T20:18:02.6451509","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:17:48.113 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:17:48.1137597","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:16:39.447 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:16:39.4474858","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:15:22.922 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:15:22.9225569","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:15:18.858 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Void .ctor(System.String, OpenTelemetry.Proto.Common.V1.AnyValue)(Object[] )\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:15:18.8580492","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:14:59.229 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:14:59.2296383","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:14:44.216 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:14:44.2163659","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:13:13.049 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:13:13.0496957","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:11:54.520 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:11:54.5205855","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:11:32.037 Error [RedisConfiguration:IO:1] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:11:32.0370761","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:10:57.933 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:10:57.9333918","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:10:17.818 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:10:17.818157","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:10:16.765 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:10:16.7654509","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:09:25.216 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:09:25.2162263","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:08:19.943 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Error converting value 1 to type 'OpenTelemetry.Proto.Common.V1.AnyValue+ValueOneofCase'. Path 'VersionedSpanContainers.1482[0].Spans[3].Attributes[9].Value.Type', line 1, position 11387373.","type":"Newtonsoft.Json.JsonSerializationException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.AnyValueConverter.ReadJson(JsonReader reader, Type objectType, AnyValue existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 117\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType)","source":"Newtonsoft.Json","innerException":null}},"details":"","timestamp":"2024-07-30T20:08:19.9433314","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:07:40.367 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Collections.Generic.List`1.System.Collections.IList.Add(Object item)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:07:40.3677915","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:05:34.447 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T20:05:34.4470854","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:04:54.259 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:04:54.2595689","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:04:30.219 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T20:04:30.2191163","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 20:03:58.860 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T20:03:58.8604506","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:59:30.933 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:59:30.9338853","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:59:12.811 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:59:12.8116596","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:58:30.946 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T19:58:30.9460295","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:57:39.441 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:57:39.4414066","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:57:21.642 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:57:21.6426557","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:56:58.511 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:56:58.5113154","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:55:23.218 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:55:23.2184981","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:55:07.913 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Buffers.BuffersExtensions.ToArray[T](ReadOnlySequence`1& sequence)\n   at StackExchange.Redis.RawResult.GetBlob() in /_/src/StackExchange.Redis/RawResult.cs:line 292\n   at StackExchange.Redis.RawResult.AsRedisValue() in /_/src/StackExchange.Redis/RawResult.cs:line 196\n   at StackExchange.Redis.ResultProcessor.RedisValueProcessor.SetResultCore(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 1759\n   at StackExchange.Redis.ResultProcessor.SetResult(PhysicalConnection connection, Message message, RawResult& result) in /_/src/StackExchange.Redis/ResultProcessor.cs:line 329\n   at StackExchange.Redis.Message.ComputeResult(PhysicalConnection connection, RawResult& result) in /_/src/StackExchange.Redis/Message.cs:line 544\n--- End of stack trace from previous location ---\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Memory","innerException":null},"details":"","timestamp":"2024-07-30T19:55:07.9134934","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:51:58.620 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:51:58.6204352","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:51:55.413 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.GC.AllocateNewArray(IntPtr typeHandle, Int32 length, GC_ALLOC_FLAGS flags)\n   at System.GC.<AllocateUninitializedArray>g__AllocateNewUninitializedArray|66_0[T](Int32 length, Boolean pinned)\n   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)\n   at System.Text.StringBuilder.Append(Char* value, Int32 valueCount)\n   at System.Text.StringBuilder.AppendHelper(String value)\n   at System.IO.StringWriter.Write(String value)\n   at Newtonsoft.Json.Utilities.JavaScriptUtils.WriteEscapedJavaScriptString(TextWriter writer, String s, Char delimiter, Boolean appendDelimiters, Boolean[] charEscapeFlags, StringEscapeHandling stringEscapeHandling, IArrayPool`1 bufferPool, Char[]& writeBuffer)\n   at Newtonsoft.Json.JsonTextWriter.WritePropertyName(String name)\n   at Newtonsoft.Json.Converters.KeyValuePairConverter.WriteJson(JsonWriter writer, Object value, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeConvertable(JsonWriter writer, JsonConverter converter, Object value, JsonContract contract, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList(JsonWriter writer, IEnumerable values, JsonArrayContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:51:55.4134515","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:49:38.959 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T19:49:38.9591899","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:48:43.819 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:48:43.8193717","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 19:45:45.460 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Linq.Lookup`2.Resize()\n   at System.Linq.Lookup`2.GetGrouping(TKey key, Boolean create)\n   at System.Linq.Lookup`2.Create(IEnumerable`1 source, Func`2 keySelector, IEqualityComparer`1 comparer)\n   at System.Linq.GroupedEnumerable`2.GetEnumerator()\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Linq","innerException":null},"details":"","timestamp":"2024-07-30T19:45:45.4605773","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:45:44.178 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":3}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at Newtonsoft.Json.Converters.KeyValuePairConverter.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Digma.Common.otlp.RepeatedKeyValueConverter.ReadJson(JsonReader reader, Type objectType, RepeatedField`1 existingValue, Boolean hasExistingValue, JsonSerializer serializer) in /src/Core/Digma.Common/otlp/ProtoObjectJsonSerializer.cs:line 198\n   at Newtonsoft.Json.JsonConverter`1.ReadJson(JsonReader reader, Type objectType, Object existingValue, JsonSerializer serializer)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.DeserializeConvertable(JsonConverter converter, JsonReader reader, Type objectType, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.SetPropertyValue(JsonProperty property, JsonConverter propertyConverter, JsonContainerContract containerContract, JsonProperty containerProperty, JsonReader reader, Object target)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateObject(Object newObject, JsonReader reader, JsonObjectContract contract, JsonProperty member, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateList(IList list, JsonReader reader, JsonArrayContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateList(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, Object existingValue, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.ResolvePropertyAndCreatorValues(JsonObjectContract contract, JsonProperty containerProperty, JsonReader reader, Type objectType)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObjectUsingCreatorWithParameters(JsonReader reader, JsonObjectContract contract, JsonProperty containerProperty, ObjectConstructor`1 creator, String id)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)\n   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)\n   at Newtonsoft.Json.JsonConvert.DeserializeObject[T](String value, JsonSerializerSettings settings)\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"Newtonsoft.Json","innerException":null},"details":"","timestamp":"2024-07-30T19:45:44.178979","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:45:17.168 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:45:17.1683133","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:39:27.926 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:39:27.9264318","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:33:24.165 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:33:24.1656321","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:32:23.773 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:32:23.7737638","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:27:38.739 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:27:38.7394583","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:25:34.961 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:25:34.9611694","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:25:24.926 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:25:24.9265571","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:23:38.539 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:23:38.5398681","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:13:56.173 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:13:56.1738846","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:02:24.949 Error [.NET ThreadPool Worker] KafkaFlow - Error executing a message batch | Data: {\"Topic\":\"digma-traces-aggregation\",\"GroupId\":\"cg-digma-traces-aggregation\",\"WorkerId\":5}","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.String.Ctor(Char c, Int32 count)\n   at StackExchange.Redis.RedisValue.ToHex(ReadOnlySpan`1 src) in /_/src/StackExchange.Redis/RedisValue.cs:line 810\n   at StackExchange.Redis.RedisValue.op_Implicit(RedisValue value) in /_/src/StackExchange.Redis/RedisValue.cs:line 787\n   at Digma.Common.TraceTempStorage.GetTrace(String traceId) in /src/Core/Digma.Common/TraceTempStorage.cs:line 56\n   at Digma.Collector.Consumers.TraceAggregationConsumer.InvokeBatch(IReadOnlyCollection`1 messages, CancellationToken cancellationToken) in /src/ApiGateways/Digma.Collector/Consumers/TraceAggregationConsumer.cs:line 38\n   at Digma.Common.Kafka.KafkaBatchConsumer`1.Invoke(IMessageContext context, MiddlewareDelegate next) in /src/Core/Digma.Common/Kafka/KafkaBatchConsumer.cs:line 48\n   at KafkaFlow.BatchConsume.BatchConsumeMiddleware.DispatchAsync(IMessageContext context, MiddlewareDelegate next)","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:02:24.9495114","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 19:01:22.443 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Collections.Generic.List`1.set_Capacity(Int32 value)\n   at System.Collections.Generic.List`1.AddWithResize(T item)\n   at System.Linq.Enumerable.SelectEnumerableIterator`2.ToList()\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T19:01:22.4431358","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 18:55:26.266 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T18:55:26.266393","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 18:48:24.548 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T18:48:24.548344","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 17:46:34.526 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T17:46:34.5263701","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 17:33:09.956 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T17:33:09.9563481","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 17:32:04.327 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T17:32:04.3270651","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"},{"message":"2024/07/30 17:14:14.761 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Exception of type 'System.OutOfMemoryException' was thrown.","exception":{"message":"Exception of type 'System.OutOfMemoryException' was thrown.","type":"System.OutOfMemoryException","stackTrace":"   at System.Text.StringBuilder.ToString()\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T17:14:14.761961","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 16:34:04.741 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Timeout awaiting response (outbound=7813KiB, inbound=0KiB, 5108ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:203224781B175AA91392DCAD5AB1CE50:Data, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 0, in-pipe: 0, out-pipe: 0, last-in: 2, cur-in: 0, sync-ops: 0, async-ops: 44, serverEndpoint: digma-redis:6379, conn-sec: 99.51, aoc: 1, mc: 1/1/0, mgr: 0 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b5ttd(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=20,QueuedItems=0,CompletedItems=12902,Timers=38), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","exception":{"message":"Timeout awaiting response (outbound=7813KiB, inbound=0KiB, 5108ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:203224781B175AA91392DCAD5AB1CE50:Data, inst: 0, qu: 0, qs: 1, aw: False, bw: SpinningDown, rs: ReadAsync, ws: Idle, in: 0, in-pipe: 0, out-pipe: 0, last-in: 2, cur-in: 0, sync-ops: 0, async-ops: 44, serverEndpoint: digma-redis:6379, conn-sec: 99.51, aoc: 1, mc: 1/1/0, mgr: 0 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b5ttd(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=9,Free=32758,Min=1,Max=32767), POOL: (Threads=20,QueuedItems=0,CompletedItems=12902,Timers=38), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T16:34:04.7416399","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 15:28:32.634 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Collection was modified; enumeration operation may not execute.","exception":{"message":"Collection was modified; enumeration operation may not execute.","type":"System.InvalidOperationException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T15:28:32.6340553","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-p28v9"},{"message":"2024/07/30 15:27:59.960 Error [.NET ThreadPool Worker] Digma.Collector.Services.UnhandledTraceProcessing.LogUnhandledTraceProcessingService - Fail to process trace BBC2CD95C30EB1215B5E66E8B540EAEB with 691 spans","exception":{"message":"The given key '182C0F1F0305A06A' was not present in the dictionary.","type":"System.Collections.Generic.KeyNotFoundException","stackTrace":"   at System.Collections.Generic.Dictionary`2.get_Item(TKey key)\n   at Digma.Collector.Services.SpanGraphInspector.ExtractErrors(SpanGraph graph, TraceScopesContainer tsc) in /src/ApiGateways/Digma.Collector/Services/SpanGraphInspector.cs:line 117\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 367\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T15:27:59.9608084","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 15:26:45.918 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Collection was modified; enumeration operation may not execute.","exception":{"message":"Collection was modified; enumeration operation may not execute.","type":"System.InvalidOperationException","stackTrace":"   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeDictionary(JsonWriter writer, IDictionary values, JsonDictionaryContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)\n   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)\n   at Newtonsoft.Json.JsonConvert.SerializeObjectInternal(Object value, Type type, JsonSerializer jsonSerializer)\n   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 64\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 45\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 144\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 137","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T15:26:45.918881","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b7w24"},{"message":"2024/07/30 15:26:15.831 Error [.NET ThreadPool Worker] Digma.Collector.Services.AliveTracesStorage - Failed to publish message: Timeout awaiting response (outbound=433KiB, inbound=0KiB, 6484ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:BB57F6364F2A5A3DA06B90DBA4C15296:Data, inst: 0, qu: 0, qs: 1, aw: False, bw: Inactive, rs: DequeueResult, ws: Idle, in: 0, in-pipe: 5, out-pipe: 0, last-in: 0, cur-in: 5, sync-ops: 0, async-ops: 62, serverEndpoint: digma-redis:6379, conn-sec: 129.52, aoc: 1, mc: 1/1/0, mgr: 1 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b5ttd(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=30,Free=32737,Min=1,Max=32767), POOL: (Threads=31,QueuedItems=53,CompletedItems=22977,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","exception":{"message":"Timeout awaiting response (outbound=433KiB, inbound=0KiB, 6484ms elapsed, timeout is 5000ms), command=SETEX, next: SETEX Trace:BB57F6364F2A5A3DA06B90DBA4C15296:Data, inst: 0, qu: 0, qs: 1, aw: False, bw: Inactive, rs: DequeueResult, ws: Idle, in: 0, in-pipe: 5, out-pipe: 0, last-in: 0, cur-in: 5, sync-ops: 0, async-ops: 62, serverEndpoint: digma-redis:6379, conn-sec: 129.52, aoc: 1, mc: 1/1/0, mgr: 1 of 2 available, clientName: digma-collector-worker-deployment-65d7559b6f-b5ttd(SE.Redis-v2.7.4.20928), IOCP: (Busy=0,Free=1000,Min=1,Max=1000), WORKER: (Busy=30,Free=32737,Min=1,Max=32767), POOL: (Threads=31,QueuedItems=53,CompletedItems=22977,Timers=31), v: 2.7.4.20928 (Please take a look at this article for some common client-side issues that can cause timeouts: https://stackexchange.github.io/StackExchange.Redis/Timeouts)","type":"StackExchange.Redis.RedisTimeoutException","stackTrace":"   at Digma.Common.TraceTempStorage.SetTrace(VersionedSpanContainer trace) in /src/Core/Digma.Common/TraceTempStorage.cs:line 63\n   at Digma.Collector.HostedServices.TraceQueueingHostedService.Callback(VersionedSpanContainer trace, IAliveTracesStorage storage) in /src/ApiGateways/Digma.Collector/HostedServices/TraceQueueingHostedService.cs:line 42\n   at Digma.Collector.Services.AliveTracesStorage.Handle(VersionedSpanContainer trace, DateTime creationTime) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 143\n   at Digma.Collector.Services.AliveTracesStorage.TimerCallback(Object state) in /src/ApiGateways/Digma.Collector/Services/AliveTracesStorage.cs:line 131","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T15:26:15.8319408","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-b5ttd"},{"message":"2024/07/30 15:23:49.553 Error [.NET ThreadPool Worker] Digma.Collector.Services.UnhandledTraceProcessing.LogUnhandledTraceProcessingService - Fail to process trace D5824492D3B47645EE3A6B3CE79CA789 with 691 spans","exception":{"message":"The given key '91A98AE1BCB90B89' was not present in the dictionary.","type":"System.Collections.Generic.KeyNotFoundException","stackTrace":"   at System.Collections.Generic.Dictionary`2.get_Item(TKey key)\n   at Digma.Collector.Services.SpanGraphInspector.ExtractErrors(SpanGraph graph, TraceScopesContainer tsc) in /src/ApiGateways/Digma.Collector/Services/SpanGraphInspector.cs:line 117\n   at Digma.Collector.Services.TraceProcessor.InternalProcessTrace(VersionedSpanContainer container) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 367\n   at Digma.Collector.Services.TraceProcessor.ProcessTrace(VersionedSpanContainer request) in /src/ApiGateways/Digma.Collector/Services/TraceProcessor.cs:line 164","source":"System.Private.CoreLib","innerException":null},"details":"","timestamp":"2024-07-30T15:23:49.5533941","application":"Collector.Worker","instacneId":"digma-collector-worker-deployment-65d7559b6f-nh8pl"}]